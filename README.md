# ๐ก *ูุธุฑุฉ ุนุงูุฉ ุนูู ุฅุถุงูุฉ GRE Real Estate*

*ุงูุงุณู ุงูููู*: gre-real-estate  
*ุงููุตู*:  
ูุธุงู ูุชูุงูู ูุจูู ุนูู WordPress ูุฅุฏุงุฑุฉ ุงูุฃุจุฑุงุฌ ุงูุณูููุฉ (ุงูุนูุงุฆุฑ)ุ ุงูููุงุฐุฌ ุงููุนูุงุฑูุฉุ ูุงูุดูู ุฏุงุฎู ุงูุฃุจุฑุงุฌุ ูุน ุฏุนู ูุงูู ูููุฑุงุซุฉ ุงูุชููุงุฆูุฉ ููุฎุตุงุฆุตุ ุงูุชูููุฏ ุงูุขูู ููุดููุ ููุงุฌูุฉ ุนุฑุถ ุงุญุชุฑุงููุฉ ููุฒูุงุฑ.

---

## ๐งฑ *ููููุงุช ุงูุฅุถุงูุฉ ุงูุฃุณุงุณูุฉ*

### 1. โ *ุฃููุงุน ุงูููุดูุฑุงุช ุงููุฎุตุตุฉ (Custom Post Types)*

| ุงูููุน        | ุงูุชุณููุฉ | ุงููุตู |
|--------------|---------|-------|
| gre_tower  | ุจุฑุฌ     | ููุซู ุงููุจูู ุงูุณููู (5โ10 ุฃุฏูุงุฑ)ุ ููุชุถูู ุฎุตุงุฆุต ุนุงูุฉ ููุจุฑุฌ ูุซู ุงููููุนุ ุนุฏุฏ ุงูุฃุฏูุงุฑุ ููุงูู ุงูุณูุงุฑุงุชุ ุฅูุฎ. |
| gre_model  | ูููุฐุฌ   | ููุซู ุชุตููู ุงูุดูุฉ ุงููุชูุฑุฑ ูู ููุณ ุงููููุน ุจูู ุฏูุฑุ ูุชุถูู ุนุฏุฏ ุงูุบุฑูุ ุงูุญูุงูุงุชุ ุงููุณุงุญุฉุ ุงูุตูุฑุ ูุณุชูู ุงูุชุดุทูุจ... |
| gre_apartment | ุดูุฉ | ุงูุดูุฉ ููุณูุงุ ูุชุชููุฏ ุชููุงุฆููุง ุนูุฏ ุฅูุดุงุก ุงูููุงุฐุฌุ ูุน ูุนุฑู ูุฑูุฏ ูุญุงูุฉ ูุณุชููุฉ (ุฌุงูุฒุฉุ ููุฏ ุงูุชุดุทูุจุ ูุจุงุนุฉ...). |

---

## ๐ *ูุจุฏุฃ ุงููุฑุงุซุฉ*

- ูู ุดูุฉ ุชุฑุซ ุฎุตุงุฆุตูุง ูู:
  - ุงูุจุฑุฌ ุงูุฐู ุชุชุจุน ูู (ูุซู ุงููููุนุ ุนุฏุฏ ุงูุฃุฏูุงุฑ)
  - ุงููููุฐุฌ ุงูุฐู ุชูุชูู ูู (ูุซู ุนุฏุฏ ุงูุบุฑูุ ุงููุณุงุญุฉุ ุงูุตูุฑ)

- ูููู ุชูุชูู ุฎุตุงุฆุต ูุณุชููุฉ:
  - *ูุนุฑู ุงูุดูุฉ*: ูุชู ุชูููุฏู ุชููุงุฆููุง ุจุตูุบุฉ:  
    {ุงุฎุชุตุงุฑ ุงูุจุฑุฌ}-{ุงุณู ุงููููุฐุฌ}-{ุฑูู ุงูุฏูุฑ}  
    ูุซุงู: TWR1-A1-3

  - *ุญุงูุฉ ุงูุดูุฉ*: (ุฌุงูุฒุฉุ ูุจุงุนุฉุ ุชุญุช ุงูุชุดุทูุจ... ููููู ุชุบููุฑูุง ูุฏููุงู)

---

## โ *ุงููุธุงุฆู ุงูุขููุฉ*

- ุนูุฏ ุฅูุดุงุก ุจุฑุฌ ูุชุญุฏูุฏ ุนุฏุฏ ุงูุฃุฏูุงุฑ ูุงูููุงุฐุฌ:
  - ูุชู *ุชูููุฏ ุงูุดูู ุชููุงุฆููุง* ุจุนุฏุฏ = (ุนุฏุฏ ุงูุฃุฏูุงุฑ ร ุนุฏุฏ ุงูููุงุฐุฌ)
  - ูู ุดูุฉ ูุชู ุฑุจุทูุง ุชููุงุฆููุง ุจุงููููุฐุฌ ูุงูุจุฑุฌ
  - ุฎุตุงุฆุต ุงูุดูู ุชุชุญุฏุซ ุชููุงุฆููุง ุนูุฏ ุชุนุฏูู ุจูุงูุงุช ุงููููุฐุฌ ุฃู ุงูุจุฑุฌ

---

## ๐งฉ *ุงููููุงุช ุงูุฃุณุงุณูุฉ ูู ุงูุฅุถุงูุฉ*

### ๐ท gre-real-estate.php
- ููุทุฉ ุฏุฎูู ุงูุฅุถุงูุฉ
- ุชุณุฌูู ุฃููุงุน ุงููุญุชูู
- ุชุญููู ูููุงุช includes/ ู admin/

### ๐ท includes/
- ูุญุชูู ุนูู ุงูููุงุณุงุช ุงููุณุคููุฉ ุนู ุชุนุฑูู ุงูุฃููุงุน:
  - GRE_Tower, GRE_Model, GRE_Apartment
- ุฏูุงู ุงููุณุงุนุฏุฉ ูุซู:
  - ุชูููุฏ ุงููุนุฑูุงุช
  - ุงูุชุญูู ูู ุงููุฑุงุซุฉ
  - ุชูุณูู ุงูุจูุงูุงุช ููุนุฑุถ

### ๐ท admin/
- ุดุงุดุงุช ุชุญุฑูุฑ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูู ููุน
- ุตูุงุฏูู ุงูููุชุง ุงููุฎุตุตุฉ (Meta Boxes)
- ุชุญููู ุฎุฑุงุฆุท Leaflet ุจุฏูู Google API
- ุชุณุฌูู ุงูููุงุฆู ุงูุฌุงูุจูุฉ ูู ููุญุฉ ุชุญูู ููุฑุฏุจุฑูุณ

### ๐ท public/
- ูููุงุช ุงูุนุฑุถ ููุฒูุงุฑ:
  - archive-gre_apartment.php, archive-gre_model.php
  - single-gre_apartment.php, single-gre_model.php, single-gre_tower.php
- ูููุงุช ุงูุชูุณูู CSS
- ุฏูุงู ุงูุนุฑุถ ูุซู gre_render_entity_details() ูุบูุฑูุง

---

## ๐ *ุงูุฎุฑุงุฆุท ูุฏุนู ุงููููุน ุงูุฌุบุฑุงูู*

- ุชุณุชุฎุฏู ููุชุจุฉ *Leaflet* ููุชูุญุฉ ุงููุตุฏุฑ (ุจุฏูู Google API Key)
- ุงููููุน ุงูุฌุบุฑุงูู ููู ุจุฑุฌ ููุญุฏุฏ ุนุจุฑ ุฎุทูุท ุงูุทูู ูุงูุนุฑุถ
- ูููู ูุงุญููุง ุชูุนูู Google Maps ุจุณูููุฉ ูู ุฎูุงู ุงูููุฏ ุงููุนุทู ุญุงูููุง

---

## ๐ฏ *ูุงุฌูุฉ ุงูุนุฑุถ ุงูุนุงูุฉ (Front-End)*

- ุชู ุจูุงุก ููุงูุจ ูุฎุตุตุฉ ูุนุฑุถ:
  - ูุงุฆูุฉ ุงูุฃุจุฑุงุฌ
  - ุชูุงุตูู ุจุฑุฌ ูุนูู
  - ูุงุฆูุฉ ุงูููุงุฐุฌ
  - ุชูุงุตูู ุงููููุฐุฌ
  - ูุงุฆูุฉ ุงูุดูู (ูุน ููุชุฑุฉ ุฐููุฉ)
  - ุชูุงุตูู ุงูุดูุฉ

- ูู ุตูุญุฉ ุชูุนุฑุถ ุจุงุณุชุฎุฏุงู ุชุตููู ููุญุฏ ูุฑุซ ูู ุงููุงูุจ ุงูุนุงู ููุนุชูุฏ ุนูู ุชูุณููุงุช CSS ูุฎุตุตุฉ ุฏุงุฎู gre-entity-single.css

---

## ๐ *ุญุงูุฉ ุงููุดุฑูุน ุงูุญุงููุฉ*

- ุชู ุชูููุฐ ุฌููุน ุฃููุงุน ุงููุญุชูู ูุฑุจุทูุง ุจุจุนุถูุง.
- ุชู ุชูุนูู ุฎุงุตูุฉ ุงูุชูููุฏ ุงูุชููุงุฆู ููุดูู.
- ุชู ุชุฌููุฒ ุตูุญุฉ ุงูุฃุฑุดูู ููู ููุน + ุตูุญุงุช ุงูุชูุงุตูู.
- ูุชู ุงูุนูู ุญุงูููุง ุนูู:
  - *ุชูููุฑ ูุงุฌูุฉ ุฐููุฉ ููููุชุฑุฉ ูุงูุจุญุซ*
  - *ุชูุซูู ูุงูุฉ ุงููุชุบูุฑุงุช ูุงุณุชุฎุฏุงููุง ูู ุงูููุงูุจ*
  - *ุชุญุณูู ูุงุฌูุงุช ุงูุฅุฏุงุฑุฉ (ููุญุฉ ุงูุชุญูู)* ูุชููู ุฃูุซุฑ ุงุญุชุฑุงููุฉ ูุณูุงุณุฉ.

---

## ๐ *ููุงุญุธุงุช ูููุทูุฑ ุงูุฌุฏูุฏ*

- ุงูุฅุถุงูุฉ ููุชูุจุฉ ุจู *PHP + HTML + CSS + JS (ุจุณูุท)* ููุชูุงููุฉ ูุน ูููู ููุฑุฏุจุฑูุณ ุงูููุงุณู.
- ุชุนุชูุฏ ุนูู CPTs ูุญููู ูุฎุตุตุฉ ูููุณ ุนูู ุฌุฏุงูู ูุฎุตุตุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- ุงูุชุตููู ูุงุจู ููุชูุณุนุฉ ูุณุชูุจููุง ููุดูู:
  - ุญุฌูุฒุงุช ุงูุดูู
  - ุฑุจุท ูุน WooCommerce
  - ุงุณุชุนุฑุงุถ ุงูุซูุงุซู ุงูุฃุจุนุงุฏ ูููุฎุทุทุงุช

---

My Plugin File list:

\* gre-real-estate.php  
 \* admin/admin-menus.php  
 \* admin/apartment-meta-boxes.php  
 \* admin/model-meta-boxes.php  
 \* admin/tower-meta-boxes.php  
 \* includes/class-apartment.php  
 \* includes/class-init-data.php  
 \* includes/class-loader.php  
 \* includes/class-model.php  
 \* includes/class-tower.php  
 \* public/public-functions.php  
 \* public/assets/css/gre-entity-single.css  
 \* public/templates/archive-gre\_apartment.php  
 \* public/templates/archive-gre\_model.php  
 \* public/templates/archive-gre\_tower.php  
 \* public/templates/page-gre\_search.php  
 \* public/templates/single-gre\_apartment.php  
 \* public/templates/single-gre\_model.php  
 \* public/templates/single-gre\_tower.php

these is the content of each file :  

gre-real-estate.php this file contains:  
\<?php  
/\*\*  
 \* Plugin Name: GRE Real Estate  
 \* Description: ุฅุฏุงุฑุฉ ุงูุฃุจุฑุงุฌ ูุงูููุงุฐุฌ ูุงูุดูู ุงูุณูููุฉ.  
 \*/
// Autoload classes  
require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/class-loader.php';  
// Init Post Types  
new GRE\_Tower();  
new GRE\_Model();  
new GRE\_Apartment();  
// Admin menus  
require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'admin/admin-menus.php';  
?\>  
   
admin/admin-menus.php this file contains:  
<?php  
// ููุงุฆู ููุญุฉ ุงูุชุญูู ูุฅุนุฏุงุฏุงุช ููุญุฉ ุงูุฅุฏุงุฑุฉ
// ุชุญููู ููุชุจุฉ OpenStreetMap (Leaflet)  
function gre\_enqueue\_leaflet\_scripts($hook) {  
    $screen \= get\_current\_screen();  
    if ($screen && $screen-\>post\_type \=== 'gre\_tower') {  
        wp\_enqueue\_style('leaflet-css', 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css');  
        wp\_enqueue\_script('leaflet-js', 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js');  
    }  
}  
add\_action('admin\_enqueue\_scripts', 'gre\_enqueue\_leaflet\_scripts');
// ุฅุนุฏุงุฏ ููุงุฆู ูุฎุตุตุฉ ููุฅุถุงูุฉ  
function gre\_add\_admin\_menus() {  
    // ูุณุชูุจูุงู ูููููุง ุฅุถุงูุฉ ุตูุญุงุช ูุฑุนูุฉ ูุฎุตุตุฉ ููุง  
    // add\_submenu\_page(...);  
}  
add\_action('admin\_menu', 'gre\_add\_admin\_menus'); ?\>






admin/apartment-meta-boxes.php this file contains: 

<?php  
add\_action('add\_meta\_boxes', 'gre\_add\_apartment\_meta\_boxes');  
add\_action('save\_post', 'gre\_save\_apartment\_meta');

// ุฅุฒุงูุฉ ูุญุฑุฑ ุงููุตูุต ูู ููุน ุงูุดูุฉ  
add\_action('init', function () {  
    remove\_post\_type\_support('gre\_apartment', 'editor');  
}, 100);

function gre\_add\_apartment\_meta\_boxes() {  
    add\_meta\_box('gre\_apartment\_details', 'ุชูุงุตูู ุงูุดูุฉ', 'gre\_render\_apartment\_meta\_box', 'gre\_apartment', 'normal', 'high');  
}

function gre\_get\_apartment\_meta($post\_id, $key, $default \= '') {  
    return get\_post\_meta($post\_id, "\_gre\_apartment\_$key", true) ?: $default;  
}

function gre\_render\_apartment\_meta\_box($post) {  
    wp\_nonce\_field('gre\_save\_apartment\_meta', 'gre\_apartment\_meta\_nonce');

    $meta\_keys \= \[  
        'apartment\_code' \=\> '',  
        'apartment\_number' \=\> '',  
        'floor\_number' \=\> '',  
        'model\_id' \=\> '',  
        'tower\_id' \=\> '',  
        'status' \=\> '',  
        'custom\_price\_usd' \=\> '',  
        'custom\_finishing\_level' \=\> '',  
        'custom\_finishing\_type' \=\> '',  
        'custom\_images' \=\> ''  
    \];

    foreach ($meta\_keys as $key \=\> $default) {  
        $meta\_keys\[$key\] \= gre\_get\_apartment\_meta($post-\>ID, $key, $default);  
    }

    echo '\<style\>  
        .gre-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }  
        .gre-full { grid-column: span 2; }  
        label { font-weight: bold; display: block; margin-bottom: 5px; }  
        input, select, textarea { width: 100%; }  
    \</style\>';

    echo '\<div class="gre-grid"\>';

    // ุนุฑุถ ุงูุญููู readonly  
    $readonly\_fields \= \[  
        'apartment\_code' \=\> 'ูุนุฑู ุงูุดูุฉ',  
        'apartment\_number' \=\> 'ุฑูู ุงูุดูุฉ',  
        'floor\_number' \=\> 'ุงูุฏูุฑ'  
    \];  
    foreach ($readonly\_fields as $key \=\> $label) {  
        echo "\<div\>\<label\>$label\</label\>\<input type='text' name='gre\_apartment\_$key' value='" . esc\_attr($meta\_keys\[$key\]) . "' readonly /\>\</div\>";  
    }

    // ุนุฑุถ ูุนูููุงุช ุงููููุฐุฌ ูุงูุจุฑุฌ  
    gre\_render\_model\_tower\_info($meta\_keys\['model\_id'\]);

    // ุญุงูุฉ ุงูุดูุฉ  
    $status\_options \= \[  
        'available' \=\> 'ูุชุงุญุฉ',  
        'sold' \=\> 'ูุจุงุนุฉ',  
        'under\_preparation' \=\> 'ููุฏ ุงูุชุฌููุฒ',  
        'for\_finishing' \=\> 'ุชุญุชุงุฌ ุชุดุทูุจ'  
    \];  
    echo '\<div\>\<label\>ุญุงูุฉ ุงูุดูุฉ\</label\>\<select name="gre\_apartment\_status"\>';  
    foreach ($status\_options as $value \=\> $label) {  
        echo "\<option value='$value'" . selected($meta\_keys\['status'\], $value, false) . "\>$label\</option\>";  
    }  
    echo '\</select\>\</div\>';

    // ุงูุณุนุฑ ุงููุฎุตุต  
    echo '\<div\>\<label\>ุณุนุฑ ูุฎุตุต (ุงุฎุชูุงุฑู)\</label\>\<input type="text" name="gre\_apartment\_custom\_price\_usd" value="' . esc\_attr($meta\_keys\['custom\_price\_usd'\]) . '" /\>\</div\>';

    // ูุณุชูู ูููุน ุงูุชุดุทูุจ  
    $select\_fields \= \[  
        'custom\_finishing\_level' \=\> \[  
            '' \=\> 'ูุฑุงุซุฉ ูู ุงููููุฐุฌ',  
            'ready' \=\> 'ูุดุทุจ',  
            'semi' \=\> 'ูุตู ุชุดุทูุจ',  
            'none' \=\> 'ุจุฏูู ุชุดุทูุจ'  
        \],  
        'custom\_finishing\_type' \=\> \[  
            '' \=\> 'ูุฑุงุซุฉ ูู ุงููููุฐุฌ',  
            'luxury' \=\> 'ูุงุฎุฑ',  
            'deluxe' \=\> 'ุฏููููุณ',  
            'normal' \=\> 'ุนุงุฏู'  
        \]  
    \];  
    foreach ($select\_fields as $key \=\> $options) {  
        $label \= $key \=== 'custom\_finishing\_level' ? 'ูุณุชูู ุงูุชุดุทูุจ (ุงุฎุชูุงุฑู)' : 'ููุน ุงูุชุดุทูุจ (ุงุฎุชูุงุฑู)';  
        echo "\<div\>\<label\>$label\</label\>\<select name='gre\_apartment\_$key'\>";  
        foreach ($options as $value \=\> $label\_option) {  
            echo "\<option value='$value'" . selected($meta\_keys\[$key\], $value, false) . "\>$label\_option\</option\>";  
        }  
        echo '\</select\>\</div\>';  
    }

    // ุงูุตูุฑ ุงููุฎุตุตุฉ  
    echo '\<div class="gre-full"\>\<label\>ุตูุฑ ูุฎุตุตุฉ ููุดูุฉ (ุฑูุงุจุท ุฃู IDs)\</label\>\<textarea name="gre\_apartment\_custom\_images"\>' . esc\_textarea($meta\_keys\['custom\_images'\]) . '\</textarea\>\</div\>';

    echo '\</div\>'; // ููุงูุฉ .gre-grid  
}

function gre\_render\_model\_tower\_info($model\_id) {  
    $model\_title \= $model\_id ? get\_the\_title($model\_id) : 'โ';  
    $tower\_id \= $model\_id ? get\_post\_meta($model\_id, '\_gre\_model\_tower\_id', true) : '';  
    $tower\_title \= $tower\_id ? get\_the\_title($tower\_id) : 'โ';

    echo '\<div\>\<label\>ุงููููุฐุฌ ุงูุชุงุจุน\</label\>\<input type="text" value="' . esc\_attr($model\_title) . '" readonly /\>\</div\>';  
    echo '\<div\>\<label\>ุงูุจุฑุฌ ุงูุชุงุจุน\</label\>\<input type="text" value="' . esc\_attr($tower\_title) . '" readonly /\>\</div\>';  
}

function gre\_save\_apartment\_meta($post\_id) {  
    if (  
        \!isset($\_POST\['gre\_apartment\_meta\_nonce'\]) ||  
        \!wp\_verify\_nonce($\_POST\['gre\_apartment\_meta\_nonce'\], 'gre\_save\_apartment\_meta') ||  
        defined('DOING\_AUTOSAVE') && DOING\_AUTOSAVE ||  
        \!current\_user\_can('edit\_post', $post\_id)  
    ) return;

    $fields \= \[  
        'apartment\_code','apartment\_number','floor\_number','model\_id','tower\_id','status',  
        'custom\_price\_usd','custom\_finishing\_level','custom\_finishing\_type','custom\_images'  
    \];

    foreach ($fields as $field) {  
        $value \= sanitize\_text\_field($\_POST\["gre\_apartment\_$field"\] ?? '');  
        update\_post\_meta($post\_id, "\_gre\_apartment\_$field", $value);  
    }  
}  
?\>

   
admin/model-meta-boxes.php this file contains:  

<?php  
add\_action('add\_meta\_boxes', 'gre\_add\_model\_meta\_boxes');  
add\_action('save\_post', 'gre\_save\_model\_meta', 10, 2);  
add\_filter('wp\_insert\_post\_data', 'gre\_set\_model\_post\_title', 10, 2);

add\_action('wp\_ajax\_gre\_generate\_model\_short\_name', function () {  
    $tower\_id \= intval($\_GET\['tower\_id'\] ?? 0);  
    $short\_name \= gre\_generate\_model\_short\_name($tower\_id);  
    if ($short\_name) {  
        wp\_send\_json\_success(\['short\_name' \=\> $short\_name\]);  
    } else {  
        wp\_send\_json\_error(\['message' \=\> 'Failed to generate short name'\]);  
    }  
});

function gre\_generate\_model\_short\_name(int $tower\_id): ?string {  
    if (\!$tower\_id) return null;

    $tower\_short \= get\_post\_meta($tower\_id, '\_gre\_tower\_short\_name', true);  
    if (\!$tower\_short) return null;

    $model\_count \= count(get\_posts(\[  
        'post\_type' \=\> 'gre\_model',  
        'post\_status' \=\> 'any',  
        'meta\_query' \=\> \[\['key' \=\> '\_gre\_model\_tower\_id', 'value' \=\> $tower\_id\]\],  
    \])) \+ 1;

    return "{$tower\_short}-M{$model\_count}";  
}

function gre\_set\_model\_post\_title(array $data, array $postarr): array {  
    if ($data\['post\_type'\] \=== 'gre\_model' && (empty(trim($data\['post\_title'\])) || $data\['post\_title'\] \=== 'ุฅุถุงูุฉ ุนููุงู')) {  
        $tower\_id \= $\_POST\['gre\_model\_tower\_id'\] ?? get\_post\_meta($postarr\['ID'\] ?? 0, '\_gre\_model\_tower\_id', true);  
        if ($tower\_id) {  
            $tower\_title \= get\_the\_title($tower\_id);  
            $model\_count \= count(get\_posts(\[  
                'post\_type' \=\> 'gre\_model',  
                'post\_status' \=\> 'any',  
                'meta\_query' \=\> \[\['key' \=\> '\_gre\_model\_tower\_id', 'value' \=\> $tower\_id\]\],  
            \])) \+ 1;  
            $data\['post\_title'\] \= "ูููุฐุฌ {$model\_count} \- {$tower\_title}";  
        }  
    }  
    return $data;  
}
function gre\_add\_model\_meta\_boxes() {  
    add\_meta\_box('gre\_model\_details', 'ุชูุงุตูู ุงููููุฐุฌ', 'gre\_render\_model\_meta\_box', 'gre\_model', 'normal', 'high');  
}

function gre\_render\_model\_meta\_box(WP\_Post $post): void {  
    wp\_nonce\_field('gre\_save\_model\_meta', 'gre\_model\_meta\_nonce');

    $fields \= \[  
        'tower\_id' \=\> '', 'code' \=\> '', 'description' \=\> '', 'area' \=\> '',  
        'rooms\_count' \=\> 0, 'bathrooms\_count' \=\> 0, 'kitchens\_count' \=\> 0,  
        'finishing\_level' \=\> '', 'finishing\_type' \=\> '', 'default\_status' \=\> '',  
        'availability\_date' \=\> '', 'price\_usd' \=\> '',  
        'has\_living\_room' \=\> '', 'has\_majlis' \=\> '', 'has\_balcony' \=\> '', 'has\_storage' \=\> '',  
        'has\_equipped\_kitchen' \=\> '', 'has\_ac' \=\> '', 'has\_fire\_safety' \=\> '',  
        'has\_cctv' \=\> '', 'has\_water\_meter' \=\> '', 'has\_electricity\_meter' \=\> '',  
        'has\_internet' \=\> '', 'has\_wc\_western' \=\> '', 'has\_jacuzzi\_sauna' \=\> ''  
    \];

    foreach ($fields as $key \=\> $default) {  
        $fields\[$key\] \= get\_post\_meta($post-\>ID, "\_gre\_model\_$key", true) ?: $default;  
    }

    if (get\_current\_screen()-\>action \=== 'add' && empty($fields\['code'\])) {  
        $towers \= get\_posts(\['post\_type' \=\> 'gre\_tower', 'posts\_per\_page' \=\> 1, 'orderby' \=\> 'ID', 'order' \=\> 'DESC'\]);  
        if (\!empty($towers)) {  
            $fields\['code'\] \= gre\_generate\_model\_short\_name($towers\[0\]-\>ID);  
            $fields\['tower\_id'\] \= $towers\[0\]-\>ID;  
        }  
    }

    echo '\<style\>.gre-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.gre-full{grid-column:span 3}label{font-weight:bold;display:block;margin-bottom:5px}input,select,textarea{width:100%}\</style\>';  
    echo '\<div class="gre-grid"\>';  
    echo '\<div\>\<label\>ุงูุจุฑุฌ ุงูุชุงุจุน\</label\>\<select name="gre\_model\_tower\_id" id="gre\_model\_tower\_id"\>';  
    $towers \= get\_posts(\['post\_type' \=\> 'gre\_tower', 'numberposts' \=\> \-1, 'orderby' \=\> 'date', 'order' \=\> 'DESC'\]);  
    foreach ($towers as $tower) {  
        $selected \= selected($fields\['tower\_id'\], $tower-\>ID, false);  
        echo "\<option value='{$tower-\>ID}' $selected\>{$tower-\>post\_title}\</option\>";  
    }  
    echo '\</select\>\</div\>';  
    echo '\<div\>\<label\>ุงูุฑูุฒ ุงููุฎุชุตุฑ\</label\>\<input type="text" name="gre\_model\_code" id="gre\_model\_code" value="' . esc\_attr($fields\['code'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ุงููุณุงุญุฉ ุงูุฅุฌูุงููุฉ\</label\>\<input type="text" name="gre\_model\_area" value="' . esc\_attr($fields\['area'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ุนุฏุฏ ุงูุบุฑู\</label\>\<input type="number" name="gre\_model\_rooms\_count" value="' . esc\_attr($fields\['rooms\_count'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ุนุฏุฏ ุงูุญููุงูุงุช\</label\>\<input type="number" name="gre\_model\_bathrooms\_count" value="' . esc\_attr($fields\['bathrooms\_count'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ุนุฏุฏ ุงููุทุงุจุฎ\</label\>\<input type="number" name="gre\_model\_kitchens\_count" value="' . esc\_attr($fields\['kitchens\_count'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ูุณุชูู ุงูุชุดุทูุจ\</label\>\<select name="gre\_model\_finishing\_level"\>  
        \<option value="ready"' . selected($fields\['finishing\_level'\], 'ready', false) . '\>ูุดุทุจ\</option\>  
        \<option value="semi"' . selected($fields\['finishing\_level'\], 'semi', false) . '\>ูุตู ุชุดุทูุจ\</option\>  
        \<option value="none"' . selected($fields\['finishing\_level'\], 'none', false) . '\>ุจุฏูู ุชุดุทูุจ\</option\>  
    \</select\>\</div\>';  
    echo '\<div\>\<label\>ููุน ุงูุชุดุทูุจ\</label\>\<select name="gre\_model\_finishing\_type"\>  
        \<option value="luxury"' . selected($fields\['finishing\_type'\], 'luxury', false) . '\>ูุงุฎุฑ\</option\>  
        \<option value="deluxe"' . selected($fields\['finishing\_type'\], 'deluxe', false) . '\>ุฏููููุณ\</option\>  
        \<option value="normal"' . selected($fields\['finishing\_type'\], 'normal', false) . '\>ุนุงุฏู\</option\>  
    \</select\>\</div\>';  
    echo '\<div\>\<label\>ุญุงูุฉ ุงูุดูู ุงูุงูุชุฑุงุถูุฉ\</label\>\<select name="gre\_model\_default\_status"\>  
        \<option value="available"' . selected($fields\['default\_status'\], 'available', false) . '\>ูุชุงุญุฉ\</option\>  
        \<option value="sold"' . selected($fields\['default\_status'\], 'sold', false) . '\>ูุจุงุนุฉ\</option\>  
        \<option value="under\_preparation"' . selected($fields\['default\_status'\], 'under\_preparation', false) . '\>ููุฏ ุงูุชุฌููุฒ\</option\>  
        \<option value="for\_finishing"' . selected($fields\['default\_status'\], 'for\_finishing', false) . '\>ุชุญุชุงุฌ ุชุดุทูุจ\</option\>  
    \</select\>\</div\>';  
    echo '\<div\>\<label\>ุชุงุฑูุฎ ุงูุชูุงูุฑ\</label\>\<input type="date" name="gre\_model\_availability\_date" value="' . esc\_attr($fields\['availability\_date'\]) . '" /\>\</div\>';  
    echo '\<div\>\<label\>ุงูุณุนุฑ (ุงุฎุชูุงุฑู ุจุงูุฏููุงุฑ)\</label\>\<input type="text" name="gre\_model\_price\_usd" value="' . esc\_attr($fields\['price\_usd'\]) . '" /\>\</div\>';

    $checkboxes \= \[  
        'has\_living\_room' \=\> 'ุตุงูุฉ ุฌููุณ', 'has\_majlis' \=\> 'ูุฌูุณ ูููุตู', 'has\_balcony' \=\> 'ุดุฑูุฉ (ุจููููุฉ)',  
        'has\_storage' \=\> 'ูุฎุฒู', 'has\_equipped\_kitchen' \=\> 'ูุทุจุฎ ูุฌููุฒ', 'has\_ac' \=\> 'ุชุฏูุฆุฉ ูุชุจุฑูุฏ',  
        'has\_fire\_safety' \=\> 'ุฃูุธูุฉ ุญูุงูุฉ', 'has\_cctv' \=\> 'ูุงููุฑุงุช ูุฑุงูุจุฉ', 'has\_water\_meter' \=\> 'ุนุฏุงุฏ ููุงู ูุณุชูู',  
        'has\_electricity\_meter' \=\> 'ุนุฏุงุฏ ููุฑุจุงุก ูุณุชูู', 'has\_internet' \=\> 'ุงุชุตุงู ุฅูุชุฑูุช',  
        'has\_wc\_western' \=\> 'ุญูุงู ุฃูุฑูุฌู', 'has\_jacuzzi\_sauna' \=\> 'ุฌุงููุฒู / ุณุงููุง'  
    \];  
    foreach ($checkboxes as $key \=\> $label) {  
        $checked \= checked($fields\[$key\], '1', false);  
        echo "\<div\>\<label\>\<input type='checkbox' name='gre\_model\_$key' value='1' $checked /\> $label\</label\>\</div\>";  
    }  
    echo '\<div class="gre-full"\>\<label\>ูุตู ุนุงู ูููููุฐุฌ\</label\>\<textarea name="gre\_model\_description"\>' . esc\_textarea($fields\['description'\]) . '\</textarea\>\</div\>';  
    echo '\</div\>';

    echo '\<script\>  
    document.addEventListener("DOMContentLoaded", function() {  
        const towerSelect \= document.getElementById("gre\_model\_tower\_id");  
        const shortNameField \= document.getElementById("gre\_model\_code");  
        const titleField \= document.getElementById("title");  
        let titleUpdated \= false;  
        let initialTitle \= titleField.value.trim();

        if (towerSelect && shortNameField && titleField) {  
            towerSelect.addEventListener("change", function() {  
                updateShortName(this.value);  
            });  
            if (towerSelect.value && (initialTitle \=== "" || initialTitle \=== "ุฅุถุงูุฉ ุนููุงู")) {  
                updateShortName(towerSelect.value);  
            }  
        }

        async function updateShortName(towerId) {  
            if (\!towerId) return;

            try {  
                const res \= await fetch(ajaxurl \+ "?action=gre\_generate\_model\_short\_name\&tower\_id=" \+ towerId);  
                const data \= await res.json();

                if (data.success && data.short\_name) {  
                    shortNameField.value \= data.short\_name;  
                    if (\!titleUpdated && (titleField.value.trim() \=== "" || titleField.value.trim() \=== "ุฅุถุงูุฉ ุนููุงู")) {  
                        titleField.value \= data.short\_name;  
                        titleUpdated \= true;  
                    }  
                } else {  
                    console.error("AJAX call failed or returned no short name:", data);  
                }  
            } catch (error) {  
                console.error("Error fetching short name:", error);  
            }  
        }  
    });  
    \</script\>';  
}

function gre\_save\_model\_meta($post\_id, $post) {  
	if (\!isset($\_POST\['gre\_model\_meta\_nonce'\]) || \!wp\_verify\_nonce($\_POST\['gre\_model\_meta\_nonce'\], 'gre\_save\_model\_meta')) return;  
	if (defined('DOING\_AUTOSAVE') && DOING\_AUTOSAVE) return;  
	if (\!current\_user\_can('edit\_post', $post\_id)) return;  
   
	$fields \= \[  
        'tower\_id','code','description','area','rooms\_count','bathrooms\_count','kitchens\_count',  
        'finishing\_level','finishing\_type','default\_status','availability\_date','price\_usd',  
        'has\_living\_room','has\_majlis','has\_balcony','has\_storage','has\_equipped\_kitchen',  
        'has\_ac','has\_fire\_safety','has\_cctv','has\_water\_meter','has\_electricity\_meter',  
        'has\_internet','has\_wc\_western','has\_jacuzzi\_sauna'  
	\];  
	$meta \= \[\];  
	foreach ($fields as $field) {  
    	$value \= isset($\_POST\["gre\_model\_$field"\]) ? sanitize\_text\_field($\_POST\["gre\_model\_$field"\]) : '';  
    	update\_post\_meta($post\_id, "\_gre\_model\_$field", $value);  
    	$meta\[$field\] \= $value;  
	}  
   
	$generated\_code \= gre\_generate\_model\_short\_name($meta\['tower\_id'\]);  
	if ($generated\_code && $generated\_code \!== $meta\['code'\]) {  
    	update\_post\_meta($post\_id, '\_gre\_model\_code', $generated\_code);  
    	$meta\['code'\] \= $generated\_code;  
	}  
   
	if (get\_post\_meta($post\_id, '\_gre\_apartment\_generated', true) \!== '1' && \!empty($meta\['tower\_id'\]) && $meta\['code'\]) {  
    	$tower\_id \= $meta\['tower\_id'\];  
    	$model\_code \= $meta\['code'\];  
    	$floors \= (int) get\_post\_meta($tower\_id, '\_gre\_tower\_floors', true);  
    	$status \= $meta\['default\_status'\];  
   
    	for ($i \= 1; $i \<= $floors; $i++) {  
        	$code \= "{$model\_code}-{$i}";  
        	$existing \= get\_posts(\[  
            	'post\_type' \=\> 'gre\_apartment',  
            	'meta\_key' \=\> '\_gre\_apartment\_apartment\_code',  
            	'meta\_value' \=\> $code,  
            	'post\_status' \=\> 'any',  
            	'numberposts' \=\> 1  
        	\]);  
        	if (empty($existing)) {  
            	wp\_insert\_post(\[  
                	'post\_type' \=\> 'gre\_apartment',  
                	'post\_status' \=\> 'publish',  
                	'post\_title' \=\> "ุดูุฉ ุงูุฏูุฑ {$i}",  
                	'meta\_input' \=\> \[  
                        '\_gre\_apartment\_apartment\_code' \=\> $code,  
                        '\_gre\_apartment\_apartment\_number' \=\> $i,  
                        '\_gre\_apartment\_floor\_number' \=\> $i,  
                        '\_gre\_apartment\_model\_id' \=\> $post\_id,  
                        '\_gre\_apartment\_tower\_id' \=\> $tower\_id,  
                    	'\_gre\_apartment\_status' \=\> $status,  
                        '\_gre\_apartment\_custom\_price\_usd' \=\> $meta\['price\_usd'\],  
                        '\_gre\_apartment\_custom\_finishing\_level' \=\> $meta\['finishing\_level'\],  
                        '\_gre\_apartment\_custom\_finishing\_type' \=\> $meta\['finishing\_type'\]  
                	\]  
            	\]);  
        	}  
    	}  
    	update\_post\_meta($post\_id, '\_gre\_apartment\_generated', '1');  
	}  
}  
   
add\_action('before\_delete\_post', function ($post\_id) {  
	$post \= get\_post($post\_id);  
	if ($post && $post-\>post\_type \=== 'gre\_model') {  
    	$apartments \= get\_posts(\[  
        	'post\_type' \=\> 'gre\_apartment',  
        	'posts\_per\_page' \=\> \-1,  
        	'meta\_query' \=\> \[\['key' \=\> '\_gre\_apartment\_model\_id', 'value' \=\> $post\_id\]\],  
    	\]);  
    	foreach ($apartments as $apt) {  
        	wp\_delete\_post($apt-\>ID, true);  
    	}  
	}  
});  
?\>  
   
   
   
   
admin/tower-meta-boxes.php this file contains:  

<?php  
add\_action('add\_meta\_boxes', 'gre\_add\_tower\_meta\_boxes');  
add\_action('save\_post', 'gre\_save\_tower\_meta');  
add\_filter('enter\_title\_here', 'gre\_change\_title\_placeholder');  
   
define('GRE\_DEFAULT\_LAT', 15.3694);  
define('GRE\_DEFAULT\_LNG', 44.1910);  
   
function gre\_change\_title\_placeholder($title) {  
	$screen \= get\_current\_screen();  
	if ($screen-\>post\_type \=== 'gre\_tower') return 'ุงุณู ุงูุจุฑุฌ';  
	return $title;  
}    
function gre\_add\_tower\_meta\_boxes() {  
	add\_meta\_box('gre\_tower\_details', 'ุชูุงุตูู ุงูุจุฑุฌ', 'gre\_render\_tower\_meta\_box', 'gre\_tower', 'normal', 'high');  
}     
function gre\_get\_tower\_meta($post\_id, $key, $default \= '') {  
	return get\_post\_meta($post\_id, "\_gre\_tower\_$key", true) ?: $default;  
}  
   
function gre\_render\_tower\_meta\_box($post) {  
	wp\_nonce\_field('gre\_save\_tower\_meta', 'gre\_tower\_meta\_nonce');  
   
	$fields \= \[  
    	'short\_name' \=\> '', 'floors' \=\> '', 'location\_desc' \=\> '', 'location\_lat' \=\> '',  
    	'location\_lng' \=\> '', 'city' \=\> 'ุฃูุงูุฉ ุงูุนุงุตูุฉ', 'district' \=\> '', 'has\_parking' \=\> '',  
    	'total\_units' \=\> '', 'available\_units' \=\> '', 'building\_type' \=\> '', 'build\_year' \=\> '',  
    	'status' \=\> '', 'elevators' \=\> '', 'has\_generator' \=\> '', 'has\_shops' \=\> '',  
    	'general\_description' \=\> ''  
	\];  
   
	foreach ($fields as $key \=\> $default) {  
    	$fields\[$key\] \= gre\_get\_tower\_meta($post-\>ID, $key, $default);  
	}  
   
	echo '\<style\>  
    	.gre-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }  
    	.gre-half { grid-column: span 2; }  
    	.gre-full { grid-column: span 4; }  
    	.gre-map-wrap { display: flex; gap: 20px; margin-top: 20px; }  
    	.gre-map { width: 50%; height: 400px; }  
    	.gre-map-fields { width: 50%; display: flex; flex-direction: column; gap: 10px; }  
    	input\[type="number"\] { max-width: 100%; }  
    	select, input\[type="text"\], textarea { width: 100%; }  
	\</style\>';  
   
	echo '\<div class="gre-grid"\>';  
	echo '\<div\>\<label\>ุงูุงุณู ุงููุฎุชุตุฑ (ุจุงูุฅูุฌููุฒูุฉ)\</label\>\<input type="text" name="gre\_tower\_short\_name" value="' . esc\_attr($fields\['short\_name'\]) . '" style="width: 100px;" /\>\</div\>';  
	echo '\<div\>\<label\>ุนุฏุฏ ุงูุฃุฏูุงุฑ\</label\>\<input type="number" name="gre\_tower\_floors" value="' . esc\_attr($fields\['floors'\]) . '" /\>\</div\>';  
	echo '\<div\>\<label\>ุนุฏุฏ ุงููุตุงุนุฏ\</label\>\<input type="number" name="gre\_tower\_elevators" value="' . esc\_attr($fields\['elevators'\]) . '" /\>\</div\>';  
	echo '\<div\>\<label\>ุณูุฉ ุงูุจูุงุก\</label\>\<input type="number" name="gre\_tower\_build\_year" value="' . esc\_attr($fields\['build\_year'\]) . '" /\>\</div\>';  
   
	$checkboxes \= \[  
    	'has\_generator' \=\> 'ูููุฏ ููุฑุจุงุฆู',  
    	'has\_parking' \=\> 'ูููู ุณูุงุฑุงุช',  
    	'has\_shops' \=\> 'ูุญูุงุช ุชุฌุงุฑูุฉ'  
	\];  
	foreach ($checkboxes as $key \=\> $label) {  
    	echo "\<div\>\<label\>\<input type='checkbox' name='gre\_tower\_$key' value='1'" . checked($fields\[$key\], '1', false) . "\> $label\</label\>\</div\>";  
	}  
   
	echo '\<div\>\<label\>ููุน ุงููุจูู\</label\>\<select name="gre\_tower\_building\_type"\>  
    	\<option value="tower"' . selected($fields\['building\_type'\], 'tower', false) . '\>ุจุฑุฌ ุจุนุฏุฉ ููุงุฐุฌ ูุดูู\</option\>  
    	\<option value="villa"' . selected($fields\['building\_type'\], 'villa', false) . '\>ููุฉ ุจูููุฐุฌ ูุญูุฏ\</option\>  
	\</select\>\</div\>';  
	echo '\</div\>';  
   
	gre\_render\_location\_fields($fields);  
   
	echo '\<div class="gre-grid"\>';  
	echo '\<div class="gre-full"\>\<label\>ุงููุตู ุงูููุงูู\</label\>\<textarea name="gre\_tower\_location\_desc"\>' . esc\_textarea($fields\['location\_desc'\]) . '\</textarea\>\</div\>';  
	echo '\<div class="gre-full"\>\<label\>ุงููุตู ุงูุนุงู\</label\>\<textarea name="gre\_tower\_general\_description"\>' . esc\_textarea($fields\['general\_description'\]) . '\</textarea\>\</div\>';  
	echo '\</div\>';  
   
	echo '\<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"\>\</script\>';  
	echo '\<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/\>';  
	echo '\<script\>  
    	const GRE\_DEFAULT\_LAT \= ' . GRE\_DEFAULT\_LAT . ';  
    	const GRE\_DEFAULT\_LNG \= ' . GRE\_DEFAULT\_LNG . ';  
   
        document.addEventListener("DOMContentLoaded", function() {  
        	var latInput \= document.getElementById("gre\_tower\_location\_lat");  
        	var lngInput \= document.getElementById("gre\_tower\_location\_lng");  
        	var lat \= parseFloat(latInput.value) || GRE\_DEFAULT\_LAT;  
        	var lng \= parseFloat(lngInput.value) || GRE\_DEFAULT\_LNG;  
        	var map \= L.map("map").setView(\[lat, lng\], 13);  
            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);  
        	var marker \= L.marker(\[lat, lng\], {draggable: true}).addTo(map);  
        	marker.on("dragend", function(e) {  
            	var position \= marker.getLatLng();  
            	latInput.value \= position.lat.toFixed(6);  
            	lngInput.value \= position.lng.toFixed(6);  
        	});  
    	});  
	\</script\>';  
}  
function gre\_render\_location\_fields($fields) {  
	echo '\<div class="gre-map-wrap"\>';  
	echo '\<div id="map" class="gre-map"\>\</div\>';  
	echo '\<div class="gre-map-fields"\>';  
	echo '\<label\>ุงุณู ุงููุฏููุฉ / ุงูููุทูุฉ\</label\>\<select name="gre\_tower\_city"\>  
    	\<option value="ุฃูุงูุฉ ุงูุนุงุตูุฉ"' . selected($fields\['city'\], 'ุฃูุงูุฉ ุงูุนุงุตูุฉ', false) . '\>ุฃูุงูุฉ ุงูุนุงุตูุฉ\</option\>  
    	\<option value="ุนุฏู"' . selected($fields\['city'\], 'ุนุฏู', false) . '\>ุนุฏู\</option\>  
    	\<option value="ุชุนุฒ"' . selected($fields\['city'\], 'ุชุนุฒ', false) . '\>ุชุนุฒ\</option\>  
    	\<option value="ุงูุญุฏูุฏุฉ"' . selected($fields\['city'\], 'ุงูุญุฏูุฏุฉ', false) . '\>ุงูุญุฏูุฏุฉ\</option\>  
    	\<option value="ุญุถุฑููุช"' . selected($fields\['city'\], 'ุญุถุฑููุช', false) . '\>ุญุถุฑููุช\</option\>  
    	\<option value="ุฅุจ"' . selected($fields\['city'\], 'ุฅุจ', false) . '\>ุฅุจ\</option\>  
    	\<option value="ุฐูุงุฑ"' . selected($fields\['city'\], 'ุฐูุงุฑ', false) . '\>ุฐูุงุฑ\</option\>  
    	\<option value="ุนูุฑุงู"' . selected($fields\['city'\], 'ุนูุฑุงู', false) . '\>ุนูุฑุงู\</option\>  
    	\<option value="ุตูุนุงุก"' . selected($fields\['city'\], 'ุตูุนุงุก', false) . '\>ุตูุนุงุก\</option\>  
    	\<option value="ูุฃุฑุจ"' . selected($fields\['city'\], 'ูุฃุฑุจ', false) . '\>ูุฃุฑุจ\</option\>  
	\</select\>';  
	echo '\<label\>ุงุณู ุงููุฏูุฑูุฉ\</label\>\<input type="text" name="gre\_tower\_district" value="' . esc\_attr($fields\['district'\]) . '" /\>';  
	echo '\<label\>ุฎุท ุงูุนุฑุถ\</label\>\<input type="text" name="gre\_tower\_location\_lat" id="gre\_tower\_location\_lat" value="' . esc\_attr($fields\['location\_lat'\]) . '" /\>';  
	echo '\<label\>ุฎุท ุงูุทูู\</label\>\<input type="text" name="gre\_tower\_location\_lng" id="gre\_tower\_location\_lng" value="' . esc\_attr($fields\['location\_lng'\]) . '" /\>';  
	echo '\<label\>ุนุฏุฏ ุงูุดูู ุงูุฅุฌูุงูู\</label\>\<input type="number" name="gre\_tower\_total\_units" value="' . esc\_attr($fields\['total\_units'\]) . '" readonly /\>';  
	echo '\<label\>ุนุฏุฏ ุงูุดูู ุงููุชููุฑุฉ\</label\>\<input type="number" name="gre\_tower\_available\_units" value="' . esc\_attr($fields\['available\_units'\]) . '" readonly /\>';  
	echo '\</div\>\</div\>';  
}  
   
function gre\_save\_tower\_field($post\_id, $key) {  
	$val \= sanitize\_text\_field($\_POST\["gre\_tower\_$key"\] ?? '');  
	update\_post\_meta($post\_id, "\_gre\_tower\_$key", $val);  
}  
   
function gre\_save\_tower\_meta($post\_id) {  
	if (  
    	\!isset($\_POST\['gre\_tower\_meta\_nonce'\]) ||  
        \!wp\_verify\_nonce($\_POST\['gre\_tower\_meta\_nonce'\], 'gre\_save\_tower\_meta') ||  
    	(defined('DOING\_AUTOSAVE') && DOING\_AUTOSAVE) ||  
    	\!current\_user\_can('edit\_post', $post\_id)  
	) return;  
   
	$fields \= \['short\_name', 'floors', 'location\_desc', 'location\_lat', 'location\_lng', 'city', 'district', 'has\_parking',  
           	'total\_units', 'available\_units', 'building\_type', 'build\_year', 'status', 'elevators', 'has\_generator',  
           	'has\_shops', 'general\_description'\];   
	foreach ($fields as $field) {  
    	gre\_save\_tower\_field($post\_id, $field);  
	}  
}  
?\>  
   
   
\* includes/class-apartment.php this file contains:  
\<?php  
class GRE\_Apartment {  
	public function \_\_construct() {  
    	add\_action('init', \[$this, 'register\_post\_type'\]);  
    	// ูุฐุง ุงูุณุทุฑ ูุงู ูุงูุต ููุฌุจ ุฅุถุงูุชู ูุชุญููู ุญููู ุงูุดูุฉ  
    	require\_once plugin\_dir\_path(\_\_FILE\_\_) . '/../admin/apartment-meta-boxes.php';  
	}  
   
	public function register\_post\_type() {  
    	register\_post\_type('gre\_apartment', \[  
        	'label' \=\> 'ุงูุดูู',  
        	'labels' \=\> \[  
            	'name'           	\=\> 'ุงูุดูู',  
            	'singular\_name'  	\=\> 'ุดูุฉ',  
            	'add\_new'        	\=\> 'ุฅุถุงูุฉ ุดูุฉ ุฌุฏูุฏุฉ',  
            	'add\_new\_item'   	\=\> 'ุฅุถุงูุฉ ุดูุฉ ุฌุฏูุฏุฉ',  
            	'edit\_item'      	\=\> 'ุชุนุฏูู ุดูุฉ',  
            	'new\_item'       	\=\> 'ุดูุฉ ุฌุฏูุฏุฉ',  
            	'view\_item'      	\=\> 'ุนุฑุถ ุงูุดูุฉ',  
            	'view\_items'     	\=\> 'ุนุฑุถ ุงูุดูู',  
            	'search\_items'   	\=\> 'ุงูุจุญุซ ูู ุงูุดูู',  
            	'not\_found'      	\=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุดูู',  
            	'not\_found\_in\_trash' \=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุดูู ูู ุณูุฉ ุงูููููุงุช',  
            	'parent\_item\_colon'  \=\> 'ุงูุดูุฉ ุงูุฃุจ:',  
            	'all\_items'      	\=\> 'ูู ุงูุดูู',  
            	'archives'       	\=\> 'ุฃุฑุดูู ุงูุดูู',  
            	'attributes'     	\=\> 'ุฎุตุงุฆุต ุงูุดูุฉ',  
            	'insert\_into\_item'   \=\> 'ุฅุฏุฑุงุฌ ูู ุงูุดูุฉ',  
            	'uploaded\_to\_this\_item' \=\> 'ุชู ุงูุฑูุน ุฅูู ูุฐู ุงูุดูุฉ',  
            	'featured\_image' 	\=\> 'ุตูุฑุฉ ุงูุดูุฉ ุงูุจุงุฑุฒุฉ',  
            	'set\_featured\_image' \=\> 'ุชุนููู ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ููุดูุฉ',  
            	'remove\_featured\_image' \=\> 'ุฅุฒุงูุฉ ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ููุดูุฉ',  
            	'use\_featured\_image' \=\> 'ุงุณุชุฎุฏุงู ูุตูุฑุฉ ุจุงุฑุฒุฉ ููุดูุฉ',  
            	'menu\_name'      	\=\> 'ุงูุดูู',  
            	'filter\_items\_list' \=\> 'ููุชุฑุฉ ูุงุฆูุฉ ุงูุดูู',  
            	'items\_list\_navigation' \=\> 'ูุงุฆูุฉ ุชุตูุญ ุงูุดูู',  
            	'items\_list'     	\=\> 'ูุงุฆูุฉ ุงูุดูู',  
            	'item\_published' 	\=\> 'ุชู ูุดุฑ ุงูุดูุฉ',  
            	'item\_published\_privately' \=\> 'ุชู ูุดุฑ ุงูุดูุฉ ุฎุงุต',  
            	'item\_reverted\_to\_draft' \=\> 'ุชูุช ุฅุนุงุฏุฉ ุงูุดูุฉ ุฅูู ูุณูุฏุฉ',  
            	'item\_scheduled' 	\=\> 'ุชู ุฌุฏููุฉ ุงูุดูุฉ',  
            	'item\_updated'   	\=\> 'ุชู ุชุญุฏูุซ ุงูุดูุฉ',  
        	\],  
        	'public'         	\=\> true,  
        	'supports'       	\=\> \['title', 'thumbnail'\],  
        	'menu\_position'  	\=\> 7,  
        	'menu\_icon'      	\=\> 'dashicons-admin-home',  
        	'has\_archive'    	\=\> true,  
        	'rewrite'        	\=\> \['slug' \=\> 'apartments'\],  
    	\]);  
	}  
}  
?\>  
   
   
 \* includes/class-init-data.php this file contains:  
\<?php  
// ููุฏ ูุงุญู ูุฅูุดุงุก ุจูุงูุงุช ุชุฌุฑูุจูุฉ ุชููุงุฆููุง  
?\>  
 \* includes/class-loader.php this file contains:  
\<?php  
spl\_autoload\_register(function ($class) {  
	if (strpos($class, 'GRE\_') \=== 0\) {  
    	$file \= plugin\_dir\_path(\_\_FILE\_\_) . 'class-' . strtolower(str\_replace('GRE\_', '', $class)) . '.php';  
    	if (file\_exists($file)) {  
        	require\_once $file;  
    	}  
	}  
});  
?\>  
 

 \* includes/class-model.php this file contains:  
\<?php  
class GRE\_Model {  
	public function \_\_construct() {  
    	add\_action('init', \[$this, 'register\_post\_type'\]);  
    	require\_once plugin\_dir\_path(\_\_FILE\_\_) . '/../admin/model-meta-boxes.php';  
	}  
   
	public function register\_post\_type() {  
    	register\_post\_type('gre\_model', \[  
        	'label' \=\> 'ุงูููุงุฐุฌ',  
        	'labels' \=\> \[  
            	'name'           	\=\> 'ุงูููุงุฐุฌ',  
            	'singular\_name'  	\=\> 'ูููุฐุฌ',  
            	'add\_new'        	\=\> 'ุฅุถุงูุฉ ูููุฐุฌ ุฌุฏูุฏ',  
            	'add\_new\_item'   	\=\> 'ุฅุถุงูุฉ ูููุฐุฌ ุฌุฏูุฏ',  
            	'edit\_item'      	\=\> 'ุชุนุฏูู ูููุฐุฌ',  
            	'new\_item'       	\=\> 'ูููุฐุฌ ุฌุฏูุฏ',  
            	'view\_item'      	\=\> 'ุนุฑุถ ุงููููุฐุฌ',  
            	'view\_items'     	\=\> 'ุนุฑุถ ุงูููุงุฐุฌ',  
            	'search\_items'   	\=\> 'ุงูุจุญุซ ูู ุงูููุงุฐุฌ',  
            	'not\_found'      	\=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ููุงุฐุฌ',  
            	'not\_found\_in\_trash' \=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ููุงุฐุฌ ูู ุณูุฉ ุงูููููุงุช',  
            	'parent\_item\_colon'  \=\> 'ุงููููุฐุฌ ุงูุฃุจ:',  
            	'all\_items'      	\=\> 'ูู ุงูููุงุฐุฌ',  
            	'archives'       	\=\> 'ุฃุฑุดูู ุงูููุงุฐุฌ',  
            	'attributes'     	\=\> 'ุฎุตุงุฆุต ุงููููุฐุฌ',  
            	'insert\_into\_item'   \=\> 'ุฅุฏุฑุงุฌ ูู ุงููููุฐุฌ',  
            	'uploaded\_to\_this\_item' \=\> 'ุชู ุงูุฑูุน ุฅูู ูุฐุง ุงููููุฐุฌ',  
            	'featured\_image' 	\=\> 'ุตูุฑุฉ ุงููููุฐุฌ ุงูุจุงุฑุฒุฉ',  
            	'set\_featured\_image' \=\> 'ุชุนููู ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ูููููุฐุฌ',  
            	'remove\_featured\_image' \=\> 'ุฅุฒุงูุฉ ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ูููููุฐุฌ',  
            	'use\_featured\_image' \=\> 'ุงุณุชุฎุฏุงู ูุตูุฑุฉ ุจุงุฑุฒุฉ ูููููุฐุฌ',  
            	'menu\_name'      	\=\> 'ุงูููุงุฐุฌ',  
            	'filter\_items\_list' \=\> 'ููุชุฑุฉ ูุงุฆูุฉ ุงูููุงุฐุฌ',  
            	'items\_list\_navigation' \=\> 'ูุงุฆูุฉ ุชุตูุญ ุงูููุงุฐุฌ',  
            	'items\_list'     	\=\> 'ูุงุฆูุฉ ุงูููุงุฐุฌ',  
            	'item\_published' 	\=\> 'ุชู ูุดุฑ ุงููููุฐุฌ',  
            	'item\_published\_privately' \=\> 'ุชู ูุดุฑ ุงููููุฐุฌ ุฎุงุต',  
            	'item\_reverted\_to\_draft' \=\> 'ุชูุช ุฅุนุงุฏุฉ ุงููููุฐุฌ ุฅูู ูุณูุฏุฉ',  
            	'item\_scheduled' 	\=\> 'ุชู ุฌุฏููุฉ ุงููููุฐุฌ',  
            	'item\_updated'   	\=\> 'ุชู ุชุญุฏูุซ ุงููููุฐุฌ',  
        	\],  
        	'public'         	\=\> true,  
        	'supports'       	\=\> \['title', 'thumbnail'\],  
        	'menu\_position'  	\=\> 6,  
        	'menu\_icon'      	\=\> 'dashicons-layout',  
        	'has\_archive'    	\=\> false,  
        	'rewrite'        	\=\> \['slug' \=\> 'models'\],  
        	'show\_in\_rest'   	\=\> false,  
    	\]);  
	}  
}  
?\>  
   
   
   
 \* includes/class-tower.php this file contains:  
\<?php  
class GRE\_Tower {  
	public function \_\_construct() {  
    	add\_action('init', \[$this, 'register\_post\_type'\]);  
    	add\_action('edit\_form\_after\_title', \[$this, 'add\_media\_button\_above\_fields'\]);  
    	require\_once plugin\_dir\_path(\_\_FILE\_\_) . '/../admin/tower-meta-boxes.php';  
	}  
   
	public function register\_post\_type() {  
    	register\_post\_type('gre\_tower', \[  
        	'label' \=\> 'ุงูุฃุจุฑุงุฌ',  
        	'labels' \=\> \[  
            	'name'           	\=\> 'ุงูุฃุจุฑุงุฌ',  
            	'singular\_name'  	\=\> 'ุจุฑุฌ',  
            	'add\_new'        	\=\> 'ุฅุถุงูุฉ ุจุฑุฌ ุฌุฏูุฏ',  
            	'add\_new\_item'   	\=\> 'ุฅุถุงูุฉ ุจุฑุฌ ุฌุฏูุฏ',  
            	'edit\_item'      	\=\> 'ุชุนุฏูู ุจุฑุฌ',  
            	'new\_item'       	\=\> 'ุจุฑุฌ ุฌุฏูุฏ',  
            	'view\_item'      	\=\> 'ุนุฑุถ ุงูุจุฑุฌ',  
            	'view\_items'     	\=\> 'ุนุฑุถ ุงูุฃุจุฑุงุฌ',  
            	'search\_items'   	\=\> 'ุงูุจุญุซ ูู ุงูุฃุจุฑุงุฌ',  
            	'not\_found'      	\=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃุจุฑุงุฌ',  
            	'not\_found\_in\_trash' \=\> 'ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃุจุฑุงุฌ ูู ุณูุฉ ุงูููููุงุช',  
            	'parent\_item\_colon'  \=\> 'ุงูุจุฑุฌ ุงูุฃุจ:',  
            	'all\_items'      	\=\> 'ูู ุงูุฃุจุฑุงุฌ',  
            	'archives'       	\=\> 'ุฃุฑุดูู ุงูุฃุจุฑุงุฌ',  
            	'attributes'     	\=\> 'ุฎุตุงุฆุต ุงูุจุฑุฌ',  
            	'insert\_into\_item'   \=\> 'ุฅุฏุฑุงุฌ ูู ุงูุจุฑุฌ',  
            	'uploaded\_to\_this\_item' \=\> 'ุชู ุงูุฑูุน ุฅูู ูุฐุง ุงูุจุฑุฌ',  
            	'featured\_image' 	\=\> 'ุตูุฑุฉ ุงูุจุฑุฌ ุงูุจุงุฑุฒุฉ',  
            	'set\_featured\_image' \=\> 'ุชุนููู ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ููุจุฑุฌ',  
            	'remove\_featured\_image' \=\> 'ุฅุฒุงูุฉ ุงูุตูุฑุฉ ุงูุจุงุฑุฒุฉ ููุจุฑุฌ',  
            	'use\_featured\_image' \=\> 'ุงุณุชุฎุฏุงู ูุตูุฑุฉ ุจุงุฑุฒุฉ ููุจุฑุฌ',  
            	'menu\_name'      	\=\> 'ุงูุฃุจุฑุงุฌ',  
            	'filter\_items\_list' \=\> 'ููุชุฑุฉ ูุงุฆูุฉ ุงูุฃุจุฑุงุฌ',  
            	'items\_list\_navigation' \=\> 'ูุงุฆูุฉ ุชุตูุญ ุงูุฃุจุฑุงุฌ',  
            	'items\_list'     	\=\> 'ูุงุฆูุฉ ุงูุฃุจุฑุงุฌ',  
            	'item\_published' 	\=\> 'ุชู ูุดุฑ ุงูุจุฑุฌ',  
            	'item\_published\_privately' \=\> 'ุชู ูุดุฑ ุงูุจุฑุฌ ุฎุงุต',  
            	'item\_reverted\_to\_draft' \=\> 'ุชูุช ุฅุนุงุฏุฉ ุงูุจุฑุฌ ุฅูู ูุณูุฏุฉ',  
            	'item\_scheduled' 	\=\> 'ุชู ุฌุฏููุฉ ุงูุจุฑุฌ',  
            	'item\_updated'   	\=\> 'ุชู ุชุญุฏูุซ ุงูุจุฑุฌ',  
        	\],  
        	'public'         	\=\> true,  
        	'supports'       	\=\> \['title', 'thumbnail'\],  
        	'menu\_position'  	\=\> 5,  
        	'menu\_icon'      	\=\> 'dashicons-building',  
        	'has\_archive'    	\=\> true,  
        	'rewrite'        	\=\> \['slug' \=\> 'towers'\],  
    	\]);  
	}  
   
	public function add\_media\_button\_above\_fields($post) {  
    	if ($post-\>post\_type \=== 'gre\_tower') {  
        	echo '\<div style="margin: 10px 0;"\>';  
        	do\_action('media\_buttons', $post-\>ID);  
        	echo '\</div\>';  
    	}  
	}  
}  
?\>  
   
   
   
\* public/public-functions.php this file contains:  
\<?php  
/\*\*  
 \* ุฏูุงู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุงูุนุงูุฉ ููุฅุถุงูุฉ.  
 \*/  
   
/\*\*  
 \* ุชุณุฌูู ูุชุถููู ุฃููุงุท ูุฎุทูุท ุงูุฅุถุงูุฉ.  
 \*/  
function gre\_enqueue\_styles() {  
	// ุชุถููู Leaflet CSS ู JS  
	wp\_enqueue\_style('leaflet-css', 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css');  
	wp\_enqueue\_script('leaflet-js', 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js', \[\], null, true);  
   
	// ุชุถููู ููู ุฃููุงุท ุงูููุงู  
	wp\_enqueue\_style('gre-entity-styles', plugin\_dir\_url(\_\_FILE\_\_) . 'assets/css/gre-entity-single.css', \[\], '1.0.0');  
}  
add\_action('wp\_enqueue\_scripts', 'gre\_enqueue\_styles');  
   
/\*\*  
 \* ุฏุงูุฉ ูุณุงุนุฏุฉ ูุชูููุฏ ุงุณุชุนูุงู meta\_query ุฏููุงูููู.  
 \*  
 \* @param array $filters ูุตูููุฉ ุงูููุงุชุฑ.  
 \* @param string $entity\_type ููุน ุงูููุงู (apartment, model, tower).  
 \* @return array ุงุณุชุนูุงู meta\_query.  
 \*/  
function gre\_build\_meta\_query($filters, $entity\_type) {  
	$meta\_query \= \[\];  
   
	foreach ($filters as $key \=\> $filter) {  
    	$meta\_key \= "\_gre\_{$entity\_type}\_{$key}";  
    	$value \= $filter\['value'\];  
    	$compare \= $filter\['compare'\] ?? '=';  
    	$type \= $filter\['type'\] ?? 'CHAR';  
   
    	if (empty($value) && $type \!== 'ARRAY') continue;  
   
    	if (is\_array($value)) {  
        	$meta\_query\[\] \= \[  
            	'key' \=\> $meta\_key,  
            	'value' \=\> $value,  
            	'compare' \=\> $compare,  
            	'type' \=\> $type,  
        	\];  
    	} else {  
        	$meta\_query\[\] \= \[  
            	'key' \=\> $meta\_key,  
            	'value' \=\> sanitize\_text\_field($value),  
            	'compare' \=\> $compare,  
            	'type' \=\> $type,  
        	\];  
    	}  
	}  
   
	return $meta\_query;  
}  
   
/\*\*  
 \* ุฏุงูุฉ ูุณุงุนุฏุฉ ูุงุณุชุฑุฏุงุฏ ูุนุฑู ุงููููุฐุฌ ูู ุนููุงูู.  
 \*  
 \* @param string $title ุนููุงู ุงููููุฐุฌ.  
 \* @return int ูุนุฑู ุงููููุฐุฌ.  
 \*/  
function gre\_get\_model\_id\_by\_title($title) {  
	$model \= get\_page\_by\_title($title, OBJECT, 'gre\_model');  
	return $model ? $model-\>ID : 0;  
}  
   
/\*\*  
 \* ุชุนุฑุถ ุชูุงุตูู ููุงู ูุญุฏุฏ (ูููุฐุฌุ ุดูุฉุ ุจุฑุฌ).  
 \*  
 \* @param int $post\_id ูุนุฑู ุงูููุดูุฑ.  
 \* @param string $type ููุน ุงูููุงู: model | apartment | tower.  
 \*/  
function gre\_render\_entity\_details($post\_id, $type \= 'model') {  
	$fields\_map \= \[\];  
   
	if ($type \=== 'model') {  
    	$fields\_map \= \[  
        	'\_gre\_model\_code'    	\=\> \['label' \=\> '\<span class="dashicons dashicons-tag"\>\</span\> ููุฏ ุงููููุฐุฌ', 'type' \=\> 'text'\],  
        	'\_gre\_model\_area'    	\=\> \['label' \=\> '\<span class="dashicons dashicons-editor-expand"\>\</span\> ุงููุณุงุญุฉ ุงูุฅุฌูุงููุฉ (ูยฒ)', 'type' \=\> 'text'\],  
        	'\_gre\_model\_rooms\_count'   \=\> \['label' \=\> '\<span class="dashicons dashicons-admin-home"\>\</span\> ุนุฏุฏ ุงูุบุฑู', 'type' \=\> 'number'\],  
        	'\_gre\_model\_bathrooms\_count' \=\> \['label' \=\> '\<span class="dashicons dashicons-bathroom"\>\</span\> ุนุฏุฏ ุงูุญูุงูุงุช', 'type' \=\> 'number'\],  
        	'\_gre\_model\_finishing\_type' \=\> \['label' \=\> '\<span class="dashicons dashicons-admin-appearance"\>\</span\> ููุน ุงูุชุดุทูุจ', 'type' \=\> 'text'\],  
        	'\_gre\_model\_finishing\_level' \=\> \['label' \=\> '\<span class="dashicons dashicons-editor-ul"\>\</span\> ูุณุชูู ุงูุชุดุทูุจ', 'type' \=\> 'text'\],  
    	\];  
	} elseif ($type \=== 'apartment') {  
    	$fields\_map \= \[  
        	'\_gre\_apartment\_apartment\_number' \=\> \['label' \=\> '\<span class="dashicons dashicons-building"\>\</span\> ุฑูู ุงูุดูุฉ', 'type' \=\> 'number'\],  
        	'\_gre\_apartment\_status'    	\=\> \['label' \=\> '\<span class="dashicons dashicons-info-outline"\>\</span\> ุงูุญุงูุฉ', 'type' \=\> 'status'\],  
        	'\_gre\_apartment\_floor\_number'   \=\> \['label' \=\> '\<span class="dashicons dashicons-editor-textcolor"\>\</span\> ุงูุฏูุฑ', 'type' \=\> 'number'\],  
        	'\_gre\_apartment\_custom\_price\_usd' \=\> \['label' \=\> '\<span class="dashicons dashicons-cart"\>\</span\> ุงูุณุนุฑ', 'type' \=\> 'price'\],  
    	\];  
	} elseif ($type \=== 'tower') {  
    	$fields\_map \= \[  
        	'\_gre\_tower\_short\_name'  	\=\> \['label' \=\> '\<span class="dashicons dashicons-tag"\>\</span\> ุงูุงุณู ุงููุฎุชุตุฑ', 'type' \=\> 'text'\],  
        	'\_gre\_tower\_floors'      	\=\> \['label' \=\> '\<span class="dashicons dashicons-editor-ol"\>\</span\> ุนุฏุฏ ุงูุฃุฏูุงุฑ', 'type' \=\> 'number'\],  
        	'\_gre\_tower\_city'        	\=\> \['label' \=\> '\<span class="dashicons dashicons-location-alt"\>\</span\> ุงููุฏููุฉ', 'type' \=\> 'text'\],  
        	'\_gre\_tower\_district'    	\=\> \['label' \=\> '\<span class="dashicons dashicons-admin-site"\>\</span\> ุงููุฏูุฑูุฉ', 'type' \=\> 'text'\],  
        	'\_gre\_tower\_build\_year'  	\=\> \['label' \=\> '\<span class="dashicons dashicons-clock"\>\</span\> ุณูุฉ ุงูุจูุงุก', 'type' \=\> 'number'\],  
        	'\_gre\_tower\_building\_type'   \=\> \['label' \=\> '\<span class="dashicons dashicons-admin-multisite"\>\</span\> ููุน ุงููุจูู', 'type' \=\> 'text'\],  
        	'\_gre\_tower\_status'      	\=\> \['label' \=\> '\<span class="dashicons dashicons-info-outline"\>\</span\> ุงูุญุงูุฉ', 'type' \=\> 'status'\],  
        	'\_gre\_tower\_total\_units' 	\=\> \['label' \=\> '\<span class="dashicons dashicons-editor-kitchensink"\>\</span\> ุนุฏุฏ ุงูุดูู ุงูุฅุฌูุงูู', 'type' \=\> 'number'\],  
        	'\_gre\_tower\_available\_units' \=\> \['label' \=\> '\<span class="dashicons dashicons-editor-ul"\>\</span\> ุนุฏุฏ ุงูุดูู ุงููุชููุฑุฉ', 'type' \=\> 'number'\],  
    	\];  
	}  
   
	if (empty($fields\_map)) return;  
   
	echo '\<ul class="gre-entity-details-list"\>';  
	foreach ($fields\_map as $meta\_key \=\> $field) {  
    	$value \= get\_post\_meta($post\_id, $meta\_key, true);  
    	if (\!empty($value)) {  
        	$display\_value \= esc\_html($value);  
        	if ($field\['type'\] \=== 'status' && $meta\_key \=== '\_gre\_apartment\_status') {  
            	$display\_value \= esc\_html(gre\_get\_apartment\_status\_label($value));  
        	}  
        	echo '\<li\>\<span class="detail-label"\>' . $field\['label'\] . ':\</span\> ' . $display\_value . '\</li\>';  
    	}  
	}  
	echo '\</ul\>';  
}  
   
/\*\*  
 \* ุฅุฑุฌุงุน ุชุณููุฉ ุงูุญุงูุฉ ุงูููุงุจูุฉ ููููุฉ ุงูุญุงูุฉ.  
 \*  
 \* @param string $status ูููุฉ ุงูุญุงูุฉ.  
 \* @return string ุชุณููุฉ ุงูุญุงูุฉ.  
 \*/  
function gre\_get\_apartment\_status\_label($status) {  
	$status\_labels \= \[  
    	'available' \=\> 'ูุชุงุญุฉ',  
    	'sold' \=\> 'ูุจุงุนุฉ',  
    	'under\_preparation' \=\> 'ููุฏ ุงูุชุฌููุฒ',  
    	'for\_finishing' \=\> 'ุชุญุชุงุฌ ุชุดุทูุจ',  
	\];  
   
	return $status\_labels\[$status\] ?? 'ุบูุฑ ูุญุฏุฏ';  
}  
   
/\*\*  
 \* ุชุนุฑุถ ุฎุฑูุทุฉ ูููุน ุงูุจุฑุฌ.  
 \*  
 \* @param int $post\_id ูุนุฑู ุงูุจุฑุฌ.  
 \*/  
function gre\_render\_tower\_location\_map($post\_id) {  
	$lat \= get\_post\_meta($post\_id, '\_gre\_tower\_location\_lat', true);  
	$lng \= get\_post\_meta($post\_id, '\_gre\_tower\_location\_lng', true);  
	$location\_desc \= get\_post\_meta($post\_id, '\_gre\_tower\_location\_desc', true);  
   
	if ($lat && $lng) {  
    	echo '\<div class="map-container"\>';  
    	echo '\<iframe src="https://www.google.com/maps?q=' . esc\_attr($lat) . ',' . esc\_attr($lng) . '\&z=17\&output=embed" width="100%" height="450" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"\>\</iframe\>';  
    	echo '\</div\>';  
	}  
   
	if ($location\_desc) {  
    	echo '\<div class="location-description"\>';  
    	echo '\<p\>' . esc\_html($location\_desc) . '\</p\>';  
    	echo '\</div\>';  
	}  
}  
?\>  
   
   
\* public/assets/css/gre-entity-single.css contains :  
/\* \==========================================================================  
ุฃููุงุท ุตูุญุงุช ุงูููุงูุงุช (ุงูุฃุจุฑุงุฌุ ุงูููุงุฐุฌุ ุงูุดูู) \- gre-entity-single.css  
\========================================================================== \*/  
   
/\* ุฃููุงุท ุนุงูุฉ ููุตูุญุฉ \*/  
.site-main {  
padding-top: 20px;  
padding-bottom: 40px;  
}  
   
.gre-entity-single {  
background-color: \#fff;  
border: 1px solid \#eee;  
border-radius: 5px;  
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);  
padding: 20px;  
margin-bottom: 30px;  
}  
   
.entry-header {  
text-align: center;  
margin-bottom: 20px;  
}  
   
.entry-title {  
margin-bottom: 10px;  
border-bottom: 2px solid \#ccc;  
padding-bottom: 10px;  
}  
   
/\* ุตูุฑุฉ ุงูููุงู \*/  
.gre-entity-thumb {  
max-width: 100%;  
height: auto;  
border-radius: 5px;  
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);  
margin-top: 15px;  
}  
   
/\* ูุณู ุงูุชูุงุตูู \*/  
.gre-entity-details {  
background-color: \#f7f9fa;  
padding: 20px;  
border-radius: 8px;  
margin-bottom: 20px;  
box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);  
}  
   
.gre-entity-details-list {  
list-style: none;  
padding: 0;  
margin: 0;  
display: grid;  
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));  
gap: 10px;  
}  
   
.gre-entity-details-list li {  
background-color: \#fff;  
padding: 10px;  
border-radius: 6px;  
border: 1px solid \#e0e0e0;  
font-size: 0.9em;  
}  
   
.detail-label {  
font-weight: bold;  
display: block;  
margin-bottom: 5px;  
}  
   
.gre-entity-details-list .dashicons {  
font-size: 14px;  
width: 14px;  
height: 14px;  
line-height: 1;  
vertical-align: middle;  
margin-right: 5px;  
}  
   
/\* ุงููุตู ุงูุนุงู \*/  
.gre-entity-description {  
background-color: \#f0f8ff;  
padding: 15px;  
border-radius: 6px;  
margin-bottom: 20px;  
font-style: italic;  
font-size: 0.95em;  
line-height: 1.5;  
color: \#555;  
}  
   
/\* ุงูุฎุฑูุทุฉ \*/  
.gre-entity-map {  
margin-bottom: 30px;  
}  
   
.gre-entity-map \#map {  
height: 350px;  
border-radius: 6px;  
box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);  
}  
   
/\* ุฃููุงุท ุฅุถุงููุฉ ูุตูุฑ ุงูุดูุฉ \*/  
.gre-entity-images {  
margin-bottom: 25px;  
}  
   
.gre-entity-images h2 {  
font-size: 1.3em;  
margin-bottom: 10px;  
border-bottom: 2px solid \#ddd;  
padding-bottom: 8px;  
text-align: center;  
}  
   
.gre-entity-images-gallery {  
display: flex;  
flex-wrap: wrap;  
justify-content: center;  
gap: 8px;  
}  
   
.gre-entity-images-gallery img {  
width: 100%;  
max-width: 120px;  
height: auto;  
object-fit: cover;  
border-radius: 5px;  
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);  
}  
   
/\* ุฃููุงุท ุฑุงุจุท ุงููููุฐุฌ ุงููุฑุชุจุท \*/  
.gre-entity-model-link {  
margin-top: 15px;  
text-align: center;  
}  
   
.gre-entity-model-link a {  
display: inline-block;  
border-radius: 5px;  
transition: background-color 0.3s ease;  
font-weight: bold;  
font-size: 1em;  
padding: 8px 16px;  
}  
   
.gre-entity-model-link a:hover {  
background-color: \#2E64FE;  
}  
   
/\* ุฃููุงุท ุฒุฑ ุงูุญุฌุฒ \*/  
.gre-entity-booking {  
text-align: center;  
margin-top: 15px;  
}  
   
.booking-btn {  
background-color: \#28a745;  
color: \#fff;  
padding: 10px 20px;  
border-radius: 6px;  
text-decoration: none;  
font-weight: bold;  
font-size: 1em;  
transition: background-color 0.3s ease;  
}  
   
/\* ุฃููุงุท ุฃุฑุดูู ุงูุดูู \*/  
.gre-apartment-archive .apartment-card-container,  
.gre-model-archive .model-card-container {  
display: grid;  
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));  
gap: 15px;  
margin-top: 25px;  
}  
   
.gre-apartment-archive .apartment-card,  
.gre-model-archive .model-card {  
background: \#fff;  
border: 1px solid \#ddd;  
border-radius: 6px;  
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);  
overflow: hidden;  
transition: transform 0.2s ease;  
}  
   
.gre-apartment-archive .apartment-card:hover,  
.gre-model-archive .model-card:hover {  
transform: translateY(-3px);  
}  
   
.gre-apartment-archive .apartment-thumb,  
.gre-model-archive .model-thumb {  
width: 100%;  
height: 150px;  
object-fit: cover;  
}  
   
.gre-apartment-archive .apartment-info,  
.gre-model-archive .model-info {  
padding: 10px;  
text-align: center;  
}  
   
.gre-apartment-archive .apartment-title,  
.gre-model-archive .model-title {  
font-size: 1.1em;  
margin-bottom: 8px;  
}  
   
.gre-apartment-archive .apartment-title a,  
.gre-model-archive .model-title a {  
color: \#333;  
text-decoration: none;  
}  
   
.gre-apartment-archive .apartment-title a:hover,  
.gre-model-archive .model-title a:hover {  
color: \#007bff;  
}  
   
.gre-apartment-archive .apartment-meta,  
.gre-model-archive .model-meta {  
font-size: 0.9em;  
color: \#777;  
margin-bottom: 4px;  
}  
   
.gre-apartment-archive .apartment-price,  
.gre-model-archive .model-price {  
font-weight: bold;  
color: \#28a745;  
margin-bottom: 8px;  
}  
   
.gre-apartment-archive .details-button,  
.gre-model-archive .details-button {  
display: inline-block;  
background-color: \#0073aa;  
color: \#fff;  
padding: 6px 12px;  
border-radius: 5px;  
text-decoration: none;  
transition: background-color 0.3s ease;  
font-size: 0.9em;  
}  
   
.gre-apartment-archive .details-button:hover,  
.gre-model-archive .details-button:hover {  
background-color: \#005f8d;  
}  
   
/\* ุฃููุงุท ูููุฐุฌ ุงูููุชุฑุฉ \*/  
.gre-entity-filter {  
margin-bottom: 25px;  
}  
   
.gre-entity-filter-form {  
background: \#f9f9f9;  
padding: 15px;  
margin-bottom: 25px;  
border-radius: 6px;  
box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);  
}  
   
.gre-entity-filter-form .filter-row {  
display: flex;  
flex-wrap: wrap;  
gap: 10px;  
align-items: flex-end;  
}  
   
.gre-entity-filter-form .filter-item {  
flex: 1 1 150px;  
}  
   
.gre-entity-filter-form label {  
display: block;  
margin-bottom: 3px;  
font-weight: bold;  
color: \#444;  
font-size: 0.9em;  
}  
   
.gre-entity-filter-form select,  
.gre-entity-filter-form input {  
width: 100%;  
padding: 4px 8px;  
border: 1px solid \#ccc;  
border-radius: 4px;  
font-size: 0.9em;  
}  
   
.gre-entity-filter-form button,  
.gre-entity-filter-form .reset-button {  
padding: 8px 16px;  
background: \#0073aa;  
color: white;  
border: none;  
border-radius: 5px;  
font-weight: bold;  
cursor: pointer;  
transition: background-color 0.2s;  
text-decoration: none;  
display: inline-block;  
font-size: 0.9em;  
}  
   
.gre-entity-filter-form button:hover,  
.gre-entity-filter-form .reset-button:hover {  
background: \#005f8d;  
}  
   
.gre-entity-filter-form .filter-submit {  
display: flex;  
gap: 8px;  
}  
   
/\* ุฃููุงุท ุฃุฑุดูู ุงูุฃุจุฑุงุฌ \*/  
.gre-tower-archive .entity-card-container {  
display: grid;  
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));  
gap: 15px;  
margin-top: 25px;  
}  
   
.gre-tower-archive .entity-card {  
background: \#fff;  
border: 1px solid \#ddd;  
border-radius: 6px;  
box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);  
overflow: hidden;  
transition: transform 0.2s ease;  
}  
   
.gre-tower-archive .entity-card:hover {  
transform: translateY(-3px);  
}  
   
.gre-tower-archive .entity-thumb {  
width: 100%;  
height: 150px;  
object-fit: cover;  
}  
   
.gre-tower-archive .entity-info {  
padding: 15px;  
text-align: center;  
}  
   
.gre-tower-archive .entity-title {  
font-size: 1.1em;  
margin-bottom: 8px;  
color: \#333;  
}  
   
.gre-tower-archive .entity-title a {  
color: \#333;  
text-decoration: none;  
}  
   
.gre-tower-archive .entity-title a:hover {  
color: \#007bff;  
}  
   
.gre-tower-archive .entity-meta {  
font-size: 0.9em;  
color: \#777;  
margin-bottom: 4px;  
}  
   
.gre-tower-archive .details-button {  
display: inline-block;  
background-color: \#0073aa;  
color: \#fff;  
padding: 8px 16px;  
border-radius: 5px;  
text-decoration: none;  
transition: background-color 0.3s ease;  
font-size: 0.9em;  
}  
   
.gre-tower-archive .details-button:hover {  
background-color: \#005f8d;  
}  
   
.gre-entity-archive .page-title {  
text-align: center;  
font-size: 1.8em;  
margin-bottom: 20px;  
color: \#333;  
}  
//End of css  
   
   
   
\* public/templates/archive-gre\_apartment.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุฃุฑุดูู ุงูุดูู \- archive-gre\_apartment.php  
 \*/  
get\_header();  
?\>  
   
\<main id="primary" class="site-main gre-entity-archive"\>  
	\<section class="gre-entity-filter"\>  
    	\<h1 class="page-title"\>ูุงุฆูุฉ ุงูุดูู ุงูุณูููุฉ\</h1\>  
    	\<form method="GET" class="gre-entity-filter-form"\>  
        	\<div class="filter-row"\>  
            	\<div class="filter-item"\>  
                	\<label for="status"\>ุงูุญุงูุฉ:\</label\>  
                	\<select name="status" id="status"\>  
                    	\<option value=""\>ุงููู\</option\>  
                    	\<option value="available" \<?php echo selected($\_GET\['status'\] ?? '', 'available'); ?\>\>ูุชุงุญุฉ\</option\>  
                    	\<option value="sold" \<?php echo selected($\_GET\['status'\] ?? '', 'sold'); ?\>\>ูุจุงุนุฉ\</option\>  
                    	\<option value="under\_preparation" \<?php echo selected($\_GET\['status'\] ?? '', 'under\_preparation'); ?\>\>ููุฏ ุงูุชุฌููุฒ\</option\>  
                    	\<option value="for\_finishing" \<?php echo selected($\_GET\['status'\] ?? '', 'for\_finishing'); ?\>\>ุชุญุชุงุฌ ุชุดุทูุจ\</option\>  
                	\</select\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="floor"\>ุงูุฏูุฑ:\</label\>  
                	\<select name="floor" id="floor"\>  
                    	\<option value=""\>ุงููู\</option\>  
                    	\<?php  
                    	// ุชุญุณูู ุงุณุชุนูุงู ุงูุฃุฏูุงุฑ  
                    	global $wpdb;  
                    	$query \= "  
                        	SELECT DISTINCT meta\_value  
                        	FROM {$wpdb-\>postmeta}  
                        	WHERE meta\_key \= '\_gre\_apartment\_floor\_number'  
                        	ORDER BY CAST(meta\_value AS UNSIGNED)  
                    	";  
                    	$distinct\_floors \= $wpdb-\>get\_col($query);  
   
                    	if (\!empty($distinct\_floors)) {  
                        	foreach ($distinct\_floors as $floor\_num) {  
                            	if (\!is\_numeric($floor\_num)) continue;  
                            	$selected \= ($\_GET\['floor'\] ?? '') \== $floor\_num ? 'selected' : '';  
                            	echo "\<option value='" . esc\_attr($floor\_num) . "' $selected\>" . esc\_html($floor\_num) . "\</option\>";  
                        	}  
                    	}  
                    	?\>  
                	\</select\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="price\_min"\>ุงูุณุนุฑ ูู:\</label\>  
                	\<input type="number" name="price\_min" id="price\_min" value="\<?php echo esc\_attr($\_GET\['price\_min'\] ?? '') ?\>" placeholder="10000"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="price\_max"\>ุฅูู:\</label\>  
                	\<input type="number" name="price\_max" id="price\_max" value="\<?php echo esc\_attr($\_GET\['price\_max'\] ?? '') ?\>" placeholder="50000"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="search\_query"\>ุจุญุซ ุจุฑูู ุงูุดูุฉ ุฃู ุงููููุฐุฌ:\</label\>  
                	\<input type="text" name="search\_query" id="search\_query" value="\<?php echo esc\_attr(sanitize\_text\_field($\_GET\['search\_query'\] ?? '')) ?\>" placeholder="ูุซูุงู: A5-T3 ุฃู M1"\>  
            	\</div\>  
   
            	\<div class="filter-item filter-submit"\>  
                	\<button type="submit"\>ุจุญุซ\</button\>  
                	\<a href="\<?php echo esc\_url(get\_post\_type\_archive\_link('gre\_apartment')); ?\>" class="reset-button"\>ุฅุนุงุฏุฉ ุชุนููู\</a\>  
            	\</div\>  
        	\</div\>  
    	\</form\>  
	\</section\>  
   
	\<section class="gre-entity-grid gre-apartment-archive"\>  
    	\<?php  
    	$paged \= get\_query\_var('paged') ?: 1;  
    	$args \= \[  
        	'post\_type' \=\> 'gre\_apartment',  
        	'posts\_per\_page' \=\> 12,  
        	'paged' \=\> $paged,  
        	'meta\_query' \=\> \[\],  
    	\];  
   
    	$filters \= \[  
        	'status' \=\> \['value' \=\> sanitize\_text\_field($\_GET\['status'\] ?? '')\],  
        	'floor\_number' \=\> \['value' \=\> intval($\_GET\['floor'\] ?? 0), 'type' \=\> 'NUMERIC'\],  
        	'custom\_price\_usd' \=\> \['value' \=\> \[intval($\_GET\['price\_min'\] ?? 0), intval($\_GET\['price\_max'\] ?? 0)\], 'type' \=\> 'NUMERIC', 'compare' \=\> 'BETWEEN'\],  
    	\];  
    	$args\['meta\_query'\] \= gre\_build\_meta\_query($filters, 'apartment');  
   
    	// ุจุญุซ ูุตู ุจุฑูู ุงูุดูุฉ ุฃู ุงุณู ุงููููุฐุฌ  
    	$search\_query \= sanitize\_text\_field($\_GET\['search\_query'\] ?? '');  
    	if (\!empty($search\_query)) {  
        	$args\['meta\_query'\]\['relation'\] \= 'OR';  
        	$args\['meta\_query'\]\[\] \= \[  
            	'key' \=\> '\_gre\_apartment\_apartment\_number',  
            	'value' \=\> sanitize\_text\_field($search\_query),  
            	'compare' \=\> 'LIKE',  
        	\];  
   
        	$model\_id \= gre\_get\_model\_id\_by\_title(sanitize\_text\_field($search\_query));  
        	if ($model\_id) {  
            	$args\['meta\_query'\]\[\] \= \[  
                	'key' \=\> '\_gre\_apartment\_model\_id',  
                	'value' \=\> $model\_id,  
                	'compare' \=\> '=',  
            	\];  
        	}  
    	}  
   
    	$apartments\_query \= new WP\_Query($args);  
   
    	if ($apartments\_query-\>have\_posts()) :  
        	echo '\<div class="apartment-card-container"\>';  
        	while ($apartments\_query-\>have\_posts()) : $apartments\_query-\>the\_post();  
            	$post\_id \= get\_the\_ID();  
            	$image \= get\_the\_post\_thumbnail\_url($post\_id, 'medium') ?: plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/default-apartment.jpg';  
            	$status \= get\_post\_meta($post\_id, '\_gre\_apartment\_status', true);  
            	$price \= get\_post\_meta($post\_id, '\_gre\_apartment\_custom\_price\_usd', true);  
            	$floor \= get\_post\_meta($post\_id, '\_gre\_apartment\_floor\_number', true);  
            	$apartment\_number \= get\_post\_meta($post\_id, '\_gre\_apartment\_apartment\_number', true);  
            	?\>  
            	\<div class="apartment-card"\>  
                	\<img src="\<?php echo esc\_url($image); ?\>" alt="\<?php echo esc\_attr(get\_the\_title()); ?\>" class="apartment-thumb"\>  
                	\<div class="apartment-info"\>  
                    	\<h2 class="apartment-title"\>\<a href="\<?php the\_permalink(); ?\>"\>\<?php the\_title(); ?\>\</a\>\</h2\>  
                    	\<p class="apartment-meta"\>ุฑูู ุงูุดูุฉ: \<?php echo esc\_html($apartment\_number); ?\>\</p\>  
                    	\<p class="apartment-meta"\>ุงูุฏูุฑ: \<?php echo esc\_html($floor); ?\>\</p\>  
                    	\<p class="apartment-meta"\>ุงูุญุงูุฉ: \<?php echo esc\_html(gre\_get\_apartment\_status\_label($status)); ?\>\</p\>  
                    	\<?php if ($price): ?\>  
                        	\<p class="apartment-price"\>ุงูุณุนุฑ: \<?php echo esc\_html($price); ?\> $\</p\>  
                    	\<?php endif; ?\>  
                    	\<a href="\<?php the\_permalink(); ?\>" class="details-button"\>ุนุฑุถ ุงูุชูุงุตูู\</a\>  
                	\</div\>  
            	\</div\>  
            	\<?php  
        	endwhile;  
        	echo '\</div\>';  
        	the\_posts\_pagination(\[  
            	'prev\_text' \=\> \_\_('โ ุงูุณุงุจู', 'textdomain'),  
            	'next\_text' \=\> \_\_('ุงูุชุงูู โ', 'textdomain'),  
        	\]);  
    	else :  
        	echo '\<p\>ูุง ุชูุฌุฏ ุดูู ูุชุงุญุฉ ุญุงููุงู.\</p\>';  
    	endif;  
   
    	wp\_reset\_postdata();  
    	?\>  
	\</section\>  
\</main\>  
   
\<?php get\_footer(); ?\>  
   
   
   
   
\* public/templates/archive-gre\_model.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุฃุฑุดูู ุงูููุงุฐุฌ \- archive-gre\_model.php  
 \*/  
get\_header();  
?\>  
   
\<main id="primary" class="site-main gre-entity-archive"\>  
	\<section class="gre-entity-filter"\>  
    	\<h1 class="page-title"\>ูุงุฆูุฉ ุงูููุงุฐุฌ ุงูุณูููุฉ\</h1\>  
    	\<form method="GET" class="gre-entity-filter-form"\>  
        	\<div class="filter-row"\>  
   
            	\<div class="filter-item"\>  
                	\<label for="search\_query"\>ุจุญุซ ุจุงูุงุณู ุฃู ุงูููุฏ:\</label\>  
                	\<input type="text" name="search\_query" id="search\_query" value="\<?php echo esc\_attr($\_GET\['search\_query'\] ?? '') ?\>" placeholder="ูุซูุงู: M1 ุฃู ุงุณู ุงููููุฐุฌ"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="rooms"\>ุนุฏุฏ ุงูุบุฑู:\</label\>  
                	\<select name="rooms" id="rooms"\>  
                    	\<option value=""\>ุงููู\</option\>  
                    	\<?php for ($i \= 1; $i \<= 6; $i++): ?\>  
                        	\<option value="\<?php echo $i; ?\>" \<?php echo selected($\_GET\['rooms'\] ?? '', $i); ?\>\>\<?php echo $i; ?\> ุบุฑู\</option\>  
                    	\<?php endfor; ?\>  
                	\</select\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="bathrooms"\>ุนุฏุฏ ุงูุญูุงูุงุช:\</label\>  
                	\<select name="bathrooms" id="bathrooms"\>  
                    	\<option value=""\>ุงููู\</option\>  
                    	\<?php for ($i \= 1; $i \<= 5; $i++): ?\>  
                        	\<option value="\<?php echo $i; ?\>" \<?php echo selected($\_GET\['bathrooms'\] ?? '', $i); ?\>\>\<?php echo $i; ?\> ุญูุงู\</option\>  
                    	\<?php endfor; ?\>  
                	\</select\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="finishing\_type"\>ููุน ุงูุชุดุทูุจ:\</label\>  
                	\<input type="text" name="finishing\_type" id="finishing\_type" value="\<?php echo esc\_attr($\_GET\['finishing\_type'\] ?? '') ?\>" placeholder="ูุซูุงู: ุณูุจุฑ ูููุณ"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="price\_min"\>ุงูุณุนุฑ ูู:\</label\>  
                	\<input type="number" name="price\_min" id="price\_min" value="\<?php echo esc\_attr($\_GET\['price\_min'\] ?? '') ?\>" placeholder="10000"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="price\_max"\>ุฅูู:\</label\>  
                	\<input type="number" name="price\_max" id="price\_max" value="\<?php echo esc\_attr($\_GET\['price\_max'\] ?? '') ?\>" placeholder="50000"\>  
            	\</div\>  
   
            	\<div class="filter-item filter-submit"\>  
                	\<button type="submit"\>ุจุญุซ\</button\>  
                	\<a href="\<?php echo esc\_url(get\_post\_type\_archive\_link('gre\_model')); ?\>" class="reset-button"\>ุฅุนุงุฏุฉ ุชุนููู\</a\>  
            	\</div\>  
        	\</div\>  
    	\</form\>  
	\</section\>  
   
	\<section class="gre-entity-grid gre-model-archive"\> \<?php  
    	$paged \= get\_query\_var('paged') ?: 1;  
    	$args \= \[  
        	'post\_type' \=\> 'gre\_model',  
        	'posts\_per\_page' \=\> 12,  
        	'paged' \=\> $paged,  
        	'meta\_query' \=\> \[\],  
        	's' \=\> sanitize\_text\_field($\_GET\['search\_query'\] ?? ''),  
    	\];  
   
    	$filters \= \[  
        	'rooms\_count' \=\> \['value' \=\> intval($\_GET\['rooms'\] ?? 0), 'type' \=\> 'NUMERIC'\],  
        	'bathrooms\_count' \=\> \['value' \=\> intval($\_GET\['bathrooms'\] ?? 0), 'type' \=\> 'NUMERIC'\],  
        	'finishing\_type' \=\> \['value' \=\> sanitize\_text\_field($\_GET\['finishing\_type'\] ?? ''), 'compare' \=\> 'LIKE'\],  
        	'price\_usd' \=\> \['value' \=\> \[intval($\_GET\['price\_min'\] ?? 0), intval($\_GET\['price\_max'\] ?? 0)\], 'type' \=\> 'NUMERIC', 'compare' \=\> 'BETWEEN'\],  
    	\];  
   
    	$args\['meta\_query'\] \= gre\_build\_meta\_query($filters, 'model');  
   
    	$models\_query \= new WP\_Query($args);  
   
    	if ($models\_query-\>have\_posts()) :  
        	echo '\<div class="entity-card-container"\>';  
        	while ($models\_query-\>have\_posts()) : $models\_query-\>the\_post();  
            	$post\_id \= get\_the\_ID();  
            	$image \= get\_the\_post\_thumbnail\_url($post\_id, 'medium') ?: plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/default-model.jpg';  
            	$area \= get\_post\_meta($post\_id, '\_gre\_model\_area', true);  
            	$rooms \= get\_post\_meta($post\_id, '\_gre\_model\_rooms\_count', true);  
            	$baths \= get\_post\_meta($post\_id, '\_gre\_model\_bathrooms\_count', true);  
            	$price \= get\_post\_meta($post\_id, '\_gre\_model\_price\_usd', true);  
        	?\>  
            	\<div class="entity-card"\>  
                	\<img src="\<?php echo esc\_url($image); ?\>" alt="\<?php the\_title\_attribute(); ?\>" class="entity-thumb"\>  
                	\<div class="entity-info"\>  
                    	\<h2 class="entity-title"\>\<a href="\<?php the\_permalink(); ?\>"\>\<?php the\_title(); ?\>\</a\>\</h2\>  
                    	\<p class="entity-meta"\>ุงููุณุงุญุฉ: \<?php echo esc\_html($area); ?\> ูยฒ\</p\>  
                    	\<p class="entity-meta"\>ุงูุบุฑู: \<?php echo esc\_html($rooms); ?\> | ุงูุญูุงูุงุช: \<?php echo esc\_html($baths); ?\>\</p\>  
                    	\<?php if ($price): ?\>  
                        	\<p class="entity-price"\>ุงูุณุนุฑ: \<?php echo esc\_html($price); ?\> $\</p\>  
                    	\<?php endif; ?\>  
                    	\<a href="\<?php the\_permalink(); ?\>" class="details-button"\>ุนุฑุถ ุงูุชูุงุตูู\</a\>  
                	\</div\>  
            	\</div\>  
        	\<?php  
        	endwhile;  
        	echo '\</div\>';  
        	wp\_reset\_postdata();  
        	the\_posts\_pagination(\[  
            	'prev\_text' \=\> \_\_('โ ุงูุณุงุจู', 'textdomain'),  
            	'next\_text' \=\> \_\_('ุงูุชุงูู โ', 'textdomain'),  
        	\]);  
    	else :  
        	echo '\<p\>ูุง ุชูุฌุฏ ููุงุฐุฌ ูุทุงุจูุฉ ุญุงููุงู.\</p\>';  
    	endif;  
   
    	wp\_reset\_postdata();  
    	?\>  
	\</section\>  
\</main\>  
\<?php get\_footer(); ?\>  
   
   
 

\* public/templates/archive-gre\_tower.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุฃุฑุดูู ุงูุฃุจุฑุงุฌ \- archive-gre\_tower.php  
 \*/  
   
get\_header();  
?\>  
\<main id="primary" class="site-main gre-entity-archive"\>  
	\<section class="gre-entity-filter"\>  
    	\<h1 class="page-title"\>ูุงุฆูุฉ ุงูุฃุจุฑุงุฌ ุงูุณูููุฉ\</h1\>  
    	\<form method="GET" class="gre-entity-filter-form"\>  
        	\<div class="filter-row"\>  
   
            	\<div class="filter-item"\>  
                	\<label for="search\_query"\>ุจุญุซ ุจุงูุงุณู:\</label\>  
                	\<input type="text" name="search\_query" id="search\_query" value="\<?php echo esc\_attr($\_GET\['search\_query'\] ?? '') ?\>" placeholder="ุงุณู ุงูุจุฑุฌ ุฃู ูุตู"\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="city"\>ุงููุฏููุฉ:\</label\>  
                	\<select name="city" id="city"\>  
                    	\<option value=""\>ุงููู\</option\>  
                    	\<option value="ุฃูุงูุฉ ุงูุนุงุตูุฉ" \<?php echo selected($\_GET\['city'\] ?? '', 'ุฃูุงูุฉ ุงูุนุงุตูุฉ'); ?\>\>ุฃูุงูุฉ ุงูุนุงุตูุฉ\</option\>  
                    	\<option value="ุนุฏู" \<?php echo selected($\_GET\['city'\] ?? '', 'ุนุฏู'); ?\>\>ุนุฏู\</option\>  
                    	\<option value="ุชุนุฒ" \<?php echo selected($\_GET\['city'\] ?? '', 'ุชุนุฒ'); ?\>\>ุชุนุฒ\</option\>  
                    	\<option value="ุงูุญุฏูุฏุฉ" \<?php echo selected($\_GET\['city'\] ?? '', 'ุงูุญุฏูุฏุฉ'); ?\>\>ุงูุญุฏูุฏุฉ\</option\>  
                    	\<option value="ุญุถุฑููุช" \<?php echo selected($\_GET\['city'\] ?? '', 'ุญุถุฑููุช'); ?\>\>ุญุถุฑููุช\</option\>  
                    	\<option value="ุฅุจ" \<?php echo selected($\_GET\['city'\] ?? '', 'ุฅุจ'); ?\>\>ุฅุจ\</option\>  
                    	\<option value="ุฐูุงุฑ" \<?php echo selected($\_GET\['city'\] ?? '', 'ุฐูุงุฑ'); ?\>\>ุฐูุงุฑ\</option\>  
                    	\<option value="ุนูุฑุงู" \<?php echo selected($\_GET\['city'\] ?? '', 'ุนูุฑุงู'); ?\>\>ุนูุฑุงู\</option\>  
                    	\<option value="ุตูุนุงุก" \<?php echo selected($\_GET\['city'\] ?? '', 'ุตูุนุงุก'); ?\>\>ุตูุนุงุก\</option\>  
                    	\<option value="ูุฃุฑุจ" \<?php echo selected($\_GET\['city'\] ?? '', 'ูุฃุฑุจ'); ?\>\>ูุฃุฑุจ\</option\>  
                	\</select\>  
            	\</div\>  
   
            	\<div class="filter-item"\>  
                	\<label for="district"\>ุงููุฏูุฑูุฉ:\</label\>  
                	\<input type="text" name="district" id="district" value="\<?php echo esc\_attr($\_GET\['district'\] ?? '') ?\>" placeholder="ูุซูุงู: ุงูุชุญุฑูุฑ"\>  
            	\</div\>  
   
            	\<div class="filter-item filter-submit"\>  
                	\<button type="submit"\>ุจุญุซ\</button\>  
                	\<a href="\<?php echo esc\_url(get\_post\_type\_archive\_link('gre\_tower')); ?\>" class="reset-button"\>ุฅุนุงุฏุฉ ุชุนููู\</a\>  
            	\</div\>  
        	\</div\>  
    	\</form\>  
	\</section\>  
   
	\<section class="gre-entity-grid gre-tower-archive"\>  
    	\<?php  
    	$paged \= get\_query\_var('paged') ?: 1;  
    	$args \= \[  
        	'post\_type' \=\> 'gre\_tower',  
        	'posts\_per\_page' \=\> 12,  
        	'paged' \=\> $paged,  
        	'meta\_query' \=\> \[\],  
        	's' \=\> sanitize\_text\_field($\_GET\['search\_query'\] ?? ''),  
    	\];  
   
    	$filters \= \[  
        	'city' \=\> \['value' \=\> sanitize\_text\_field($\_GET\['city'\] ?? ''), 'compare' \=\> 'LIKE'\],  
        	'district' \=\> \['value' \=\> sanitize\_text\_field($\_GET\['district'\] ?? ''), 'compare' \=\> 'LIKE'\],  
    	\];  
   
    	$args\['meta\_query'\] \= gre\_build\_meta\_query($filters, 'tower');  
   
    	$towers\_query \= new WP\_Query($args);  
   
    	if ($towers\_query-\>have\_posts()) :  
        	echo '\<div class="entity-card-container"\>';  
        	while ($towers\_query-\>have\_posts()) : $towers\_query-\>the\_post();  
            	$post\_id \= get\_the\_ID();  
            	$image \= get\_the\_post\_thumbnail\_url($post\_id, 'medium') ?: plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/default-tower.jpg';  
            	$short\_name \= get\_post\_meta($post\_id, '\_gre\_tower\_short\_name', true);  
            	$city \= get\_post\_meta($post\_id, '\_gre\_tower\_city', true);  
            	$district \= get\_post\_meta($post\_id, '\_gre\_tower\_district', true);  
            	$floors \= get\_post\_meta($post\_id, '\_gre\_tower\_floors', true);  
            	$total\_units \= get\_post\_meta($post\_id, '\_gre\_tower\_total\_units', true);  
   
            	// Combine city and district for display  
            	$location \= \!empty($city) ? esc\_html($city) : '';  
            	if (\!empty($district)) {  
                	$location .= \!empty($location) ? ' \- ' . esc\_html($district) : esc\_html($district);  
            	}  
    	?\>  
            	\<div class="entity-card"\>  
                	\<img src="\<?php echo esc\_url($image); ?\>" alt="\<?php the\_title\_attribute(); ?\>" class="entity-thumb"\>  
                	\<div class="entity-info"\>  
                    	\<h2 class="entity-title"\>\<a href="\<?php the\_permalink(); ?\>"\>\<?php the\_title(); ?\>\</a\>\</h2\>  
                    	\<?php if ($short\_name): ?\>  
                        	\<p class="entity-meta"\>ุงูุงุณู ุงููุฎุชุตุฑ: \<?php echo esc\_html($short\_name); ?\>\</p\>  
                    	\<?php endif; ?\>  
   
                    	\<?php if ($location): ?\>  
                        	\<p class="entity-meta"\>ุงููููุน: \<?php echo esc\_html($location); ?\>\</p\>  
                    	\<?php endif; ?\>  
   
                    	\<?php if ($floors): ?\>  
                        	\<p class="entity-meta"\>ุนุฏุฏ ุงูุฃุฏูุงุฑ: \<?php echo esc\_html($floors); ?\>\</p\>  
                    	\<?php endif; ?\>  
   
                    	\<?php if ($total\_units): ?\>  
                        	\<p class="entity-meta"\>ุนุฏุฏ ุงูุดูู ุงูุฅุฌูุงูู: \<?php echo esc\_html($total\_units); ?\>\</p\>  
                    	\<?php endif; ?\>  
                    	\<a href="\<?php the\_permalink(); ?\>" class="details-button"\>ุนุฑุถ ุงูุชูุงุตูู\</a\>  
                	\</div\>  
            	\</div\>  
    	\<?php  
        	endwhile;  
        	echo '\</div\>';  
        	wp\_reset\_postdata();  
        	the\_posts\_pagination(\[  
            	'prev\_text' \=\> \_\_('โ ุงูุณุงุจู', 'textdomain'),  
            	'next\_text' \=\> \_\_('ุงูุชุงูู โ', 'textdomain'),  
        	\]);  
    	else :  
        	echo '\<p\>ูุง ุชูุฌุฏ ุฃุจุฑุงุฌ ูุทุงุจูุฉ ุญุงููุงู.\</p\>';  
    	endif;  
    	?\>  
	\</section\>  
\</main\>  
\<?php get\_footer(); ?\>  
   
\* public/templates/page-gre\_search.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุตูุญุฉ ุงูุจุญุซ ุงูููุญุฏ \- page-gre\_search.php  
 \*/  
get\_header();  
   
$q \= sanitize\_text\_field($\_GET\['q'\] ?? '');  
$type \= $\_GET\['type'\] ?? '';  
$city \= sanitize\_text\_field($\_GET\['city'\] ?? '');  
$price\_min \= intval($\_GET\['price\_min'\] ?? 0);  
$price\_max \= intval($\_GET\['price\_max'\] ?? 0);  
   
$post\_type \= $type ?: \['gre\_tower', 'gre\_model', 'gre\_apartment'\];  
   
$args \= \[  
	'post\_type' \=\> $post\_type,  
	'posts\_per\_page' \=\> 12,  
	'paged' \=\> get\_query\_var('paged') ?: 1,  
	's' \=\> $q,  
	'meta\_query' \=\> \[\],  
\];  
   
// ููุชุฑุฉ ุงููุฏููุฉ  
if ($city) {  
	$args\['meta\_query'\]\[\] \= \[  
    	'key' \=\> $type \=== 'gre\_model' ? '\_gre\_model\_city' : '\_gre\_tower\_city',  
    	'value' \=\> $city,  
    	'compare' \=\> 'LIKE'  
	\];  
}  
// ููุชุฑุฉ ุงูุณุนุฑ ููููุงุฐุฌ ุฃู ุงูุดูู  
if ($price\_min && $price\_max) {  
	$args\['meta\_query'\]\[\] \= \[  
    	'key' \=\> $type \=== 'gre\_model' ? '\_gre\_model\_price\_usd' : '\_gre\_apartment\_custom\_price\_usd',  
    	'value' \=\> \[$price\_min, $price\_max\],  
    	'type' \=\> 'NUMERIC',  
    	'compare' \=\> 'BETWEEN'  
	\];  
}  
   
$query \= new WP\_Query($args);  
?\>   
\<main id="primary" class="site-main gre-entity-archive"\>  
	\<section class="gre-entity-filter"\>  
    	\<h1 class="page-title"\>ุงูุจุญุซ ุงูููุญุฏ\</h1\>  
    	\<form method="get" class="gre-entity-filter-form"\>  
        	\<div class="filter-row"\>  
            	\<input type="text" name="q" placeholder="ุงุจุญุซ ุจุงูุงุณู ุฃู ุงูููุฏ..." value="\<?php echo esc\_attr($q); ?\>"\>  
            	\<select name="type"\>  
                	\<option value=""\>ุงููู\</option\>  
                	\<option value="gre\_tower" \<?php selected($type, 'gre\_tower'); ?\>\>ุฃุจุฑุงุฌ\</option\>  
                	\<option value="gre\_model" \<?php selected($type, 'gre\_model'); ?\>\>ููุงุฐุฌ\</option\>  
                	\<option value="gre\_apartment" \<?php selected($type, 'gre\_apartment'); ?\>\>ุดูู\</option\>  
            	\</select\>  
            	\<select name="city"\>  
                	\<option value=""\>ุงููุฏููุฉ\</option\>  
                	\<option value="ุตูุนุงุก" \<?php selected($city, 'ุตูุนุงุก'); ?\>\>ุตูุนุงุก\</option\>  
                	\<option value="ุนุฏู" \<?php selected($city, 'ุนุฏู'); ?\>\>ุนุฏู\</option\>  
            	\</select\>  
            	\<input type="number" name="price\_min" placeholder="ุงูุณุนุฑ ูู" value="\<?php echo esc\_attr($price\_min); ?\>"\>  
            	\<input type="number" name="price\_max" placeholder="ุฅูู" value="\<?php echo esc\_attr($price\_max); ?\>"\>  
            	\<button type="submit"\>ุจุญุซ\</button\>  
        	\</div\>  
    	\</form\>  
	\</section\>  
   
	\<section class="gre-entity-grid"\>  
    	\<?php  
    	if ($query-\>have\_posts()) :  
        	echo '\<div class="entity-card-container"\>';  
        	while ($query-\>have\_posts()) : $query-\>the\_post();  
            	$post\_type \= get\_post\_type();  
            	$post\_id \= get\_the\_ID();  
            	$image \= get\_the\_post\_thumbnail\_url($post\_id, 'medium') ?: plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/default.png';  
    	?\>  
            	\<div class="entity-card"\>  
                	\<img src="\<?php echo esc\_url($image); ?\>" alt="\<?php the\_title\_attribute(); ?\>" class="entity-thumb"\>  
                	\<div class="entity-info"\>  
                    	\<h2 class="entity-title"\>\<a href="\<?php the\_permalink(); ?\>"\>\<?php the\_title(); ?\>\</a\>\</h2\>  
                    	\<p class="entity-meta"\>ุงูููุน: \<?php echo ($post\_type \== 'gre\_tower' ? 'ุจุฑุฌ' : ($post\_type \== 'gre\_model' ? 'ูููุฐุฌ' : 'ุดูุฉ')); ?\>\</p\>  
                    	\<a href="\<?php the\_permalink(); ?\>" class="details-button"\>ุนุฑุถ ุงูุชูุงุตูู\</a\>  
                	\</div\>  
            	\</div\>  
    	\<?php  
        	endwhile;  
        	echo '\</div\>';  
        	the\_posts\_pagination(\[  
            	'prev\_text' \=\> \_\_('โ ุงูุณุงุจู'),  
            	'next\_text' \=\> \_\_('ุงูุชุงูู โ'),  
        	\]);  
    	else :  
        	echo '\<p\>ูุง ุชูุฌุฏ ูุชุงุฆุฌ ูุทุงุจูุฉ ุญุงููุงู.\</p\>';  
    	endif;  
    	wp\_reset\_postdata();  
    	?\>  
	\</section\>  
\</main\>  
\<?php get\_footer(); ?\>  
   
   
 

 \* public/templates/single-gre\_apartment.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุนุฑุถ ุชูุงุตูู ุงูุดูุฉ \- single-gre\_apartment.php  
 \*/  
   
get\_header();  
   
if (have\_posts()) :  
	while (have\_posts()) : the\_post();  
    	$post\_id \= get\_the\_ID();  
   
    	// ุตูุฑุฉ ุงูุดูุฉ (ุฅุฐุง ูุงูุช ููุฌูุฏุฉ)  
    	$image\_url \= get\_the\_post\_thumbnail\_url($post\_id, 'large');  
    	$model\_id \= get\_post\_meta($post\_id, '\_gre\_apartment\_model\_id', true);  
    	$status \= get\_post\_meta($post\_id, '\_gre\_apartment\_status', true);  
    	$custom\_price\_usd \= get\_post\_meta($post\_id, '\_gre\_apartment\_custom\_price\_usd', true);  
    	$custom\_images \= get\_post\_meta($post\_id, '\_gre\_apartment\_custom\_images', true);  
?\>  
    	\<main id="primary" class="site-main"\>  
        	\<article id="post-\<?php the\_ID(); ?\>" \<?php post\_class('gre-entity-single'); ?\>\>  
            	\<header class="entry-header"\>  
                	\<h1 class="entry-title"\>\<?php the\_title(); ?\>\</h1\>  
                	\<?php if ($image\_url) : ?\>  
                    	\<img class="gre-entity-thumb" src="\<?php echo esc\_url($image\_url); ?\>" alt="\<?php the\_title\_attribute(); ?\>"\>  
                	\<?php endif; ?\>  
            	\</header\>  
   
            	\<section class="gre-entity-details"\>  
                	\<h2\>ุชูุงุตูู ุงูุดูุฉ\</h2\>  
                	\<?php gre\_render\_entity\_details($post\_id, 'apartment'); ?\>  
            	\</section\>  
   
            	\<?php if ($status) : ?\>  
                	\<section class="gre-entity-status"\>  
                    	\<h2\>ุงูุญุงูุฉ\</h2\>  
                    	\<p\>\<?php echo esc\_html(gre\_get\_apartment\_status\_label($status)); ?\>\</p\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($custom\_price\_usd) : ?\>  
                	\<section class="gre-entity-price"\>  
                    	\<h2\>ุงูุณุนุฑ ุงููุฎุตุต\</h2\>  
                    	\<p\>\<?php echo esc\_html($custom\_price\_usd); ?\> ุฏููุงุฑ ุฃูุฑููู\</p\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($custom\_images) : ?\>  
                	\<section class="gre-entity-images"\>  
                    	\<h2\>ุตูุฑ ุฅุถุงููุฉ\</h2\>  
                    	\<div class="gre-entity-images-gallery"\>  
                        	\<?php  
                        	$image\_ids \= explode(',', $custom\_images);  
                        	foreach ($image\_ids as $image\_id) {  
                            	$image\_url \= wp\_get\_attachment\_url(trim($image\_id));  
                            	if ($image\_url) {  
                                	echo '\<img src="' . esc\_url($image\_url) . '" alt="ุตูุฑุฉ ุดูุฉ" loading="lazy"\>';  
                            	}  
                        	}  
                        	?\>  
                    	\</div\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($status \=== 'available') : ?\>  
                	\<section class="gre-entity-booking"\>  
                    	\<h2\>ุญุฌุฒ ุงูุดูุฉ\</h2\>  
                    	\<a href="https://wa.me/967XXXXXXXXX?text=ูุฑุญุจุงูุ ุฃุฑุบุจ ุจุญุฌุฒ ุงูุดูุฉ ุฑูู \<?php echo get\_post\_meta($post\_id, '\_gre\_apartment\_apartment\_number', true); ?\>" class="booking-btn" target="\_blank"\>ุงุญุฌุฒ ุงูุขู ุนุจุฑ ูุงุชุณุงุจ\</a\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($model\_id) : ?\>  
                	\<section class="gre-entity-model-link"\>  
                    	\<h2\>ุงููููุฐุฌ ุงููุฑุชุจุท\</h2\>  
                    	\<a href="\<?php echo esc\_url(get\_permalink($model\_id)); ?\>"\>ุนุฑุถ ุชูุงุตูู ุงููููุฐุฌ\</a\>  
                	\</section\>  
            	\<?php endif; ?\>  
        	\</article\>  
    	\</main\>  
\<?php  
	endwhile;  
endif;  
   
get\_sidebar();  
get\_footer();  
?\>  
   
   
   
 

 \* public/templates/single-gre\_model.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุนุฑุถ ุชูุงุตูู ุงููููุฐุฌ \- single-gre\_model.php  
 \*/  
   
get\_header();  
if (have\_posts()) :  
	while (have\_posts()) : the\_post();  
    	$post\_id \= get\_the\_ID();  
    	// ุจูุงูุงุช ูุฎุตุตุฉ  
    	$image\_url \= get\_the\_post\_thumbnail\_url($post\_id, 'large');  
    	$description \= get\_post\_meta($post\_id, '\_gre\_model\_description', true);  
    	$price\_usd \= get\_post\_meta($post\_id, '\_gre\_model\_price\_usd', true);  
?\>  
    	\<main id="primary" class="site-main"\>  
        	\<article id="post-\<?php the\_ID(); ?\>" \<?php post\_class('gre-entity-single'); ?\>\>  
            	\<header class="entry-header"\>  
                	\<h1 class="entry-title"\>\<?php the\_title(); ?\>\</h1\>  
                	\<?php if ($image\_url) : ?\>  
                    	\<img class="gre-entity-thumb" src="\<?php echo esc\_url($image\_url); ?\>" alt="\<?php the\_title\_attribute(); ?\>"\>  
                	\<?php endif; ?\>  
            	\</header\>  
   
            	\<section class="gre-entity-details"\>  
                	\<h2\>ุชูุงุตูู ุงููููุฐุฌ\</h2\>  
                	\<?php gre\_render\_entity\_details($post\_id, 'model'); ?\>  
            	\</section\>  
   
            	\<?php if ($description) : ?\>  
                	\<section class="gre-entity-description"\>  
                    	\<h2\>ุงููุตู\</h2\>  
                    	\<p\>\<?php echo esc\_html($description); ?\>\</p\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($price\_usd) : ?\>  
                	\<section class="gre-entity-price"\>  
                    	\<h2\>ุงูุณุนุฑ\</h2\>  
                    	\<p\>\<?php echo esc\_html($price\_usd); ?\> ุฏููุงุฑ ุฃูุฑููู\</p\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<section class="gre-related-apartments"\>  
                	\<h2\>ุงูุดูู ุงูุชุงุจุนุฉ ููุฐุง ุงููููุฐุฌ\</h2\>  
                	\<ul class="apartment-list"\>  
                    	\<?php  
                    	$args \= \[  
                        	'post\_type' \=\> 'gre\_apartment',  
                        	'meta\_query' \=\> \[  
                            	\[  
                                	'key' \=\> '\_gre\_apartment\_model\_id',  
                                	'value' \=\> $post\_id,  
                                	'compare' \=\> '=',  
                            	\],  
                        	\],  
                        	'posts\_per\_page' \=\> \-1,  
                    	\];  
                    	$apartments \= get\_posts($args);  
                    	foreach ($apartments as $apt) {  
                        	echo '\<li\>\<a href="' . get\_permalink($apt-\>ID) . '"\>' . esc\_html(get\_the\_title($apt-\>ID)) . '\</a\>\</li\>';  
                    	}  
                    	?\>  
                	\</ul\>  
            	\</section\>  
        	\</article\>  
    	\</main\>  
\<?php  
	endwhile;  
endif;  
 get\_sidebar();  
get\_footer();  
?\>  
   
 

 \* public/templates/single-gre\_tower.php this file contains:  
\<?php  
/\*\*  
 \* ูุงูุจ ุนุฑุถ ุชูุงุตูู ุงูุจุฑุฌ \- single-gre\_tower.php  
 \*/  
   
get\_header(); // ุชุฑููุณุฉ ุงููุงูุจ  
   
if (have\_posts()) :  
	while (have\_posts()) : the\_post();  
    	$post\_id \= get\_the\_ID();  
     	// ุจูุงูุงุช ูุฎุตุตุฉ  
    	$short\_name \= get\_post\_meta($post\_id, '\_gre\_tower\_short\_name', true);  
    	$floors \= get\_post\_meta($post\_id, '\_gre\_tower\_floors', true);  
    	$city \= get\_post\_meta($post\_id, '\_gre\_tower\_city', true);  
    	$district \= get\_post\_meta($post\_id, '\_gre\_tower\_district', true);  
    	$lat \= get\_post\_meta($post\_id, '\_gre\_tower\_location\_lat', true);  
    	$lng \= get\_post\_meta($post\_id, '\_gre\_tower\_location\_lng', true);  
    	$desc \= get\_post\_meta($post\_id, '\_gre\_tower\_general\_description', true);  
    	$image\_url \= get\_the\_post\_thumbnail\_url($post\_id, 'large');  
?\>  
    	\<main id="primary" class="site-main"\>  
        	\<article id="post-\<?php the\_ID(); ?\>" \<?php post\_class('gre-entity-single'); ?\>\>  
            	\<header class="entry-header tower-header"\>  
                	\<h1 class="tower-title"\>\<?php the\_title(); ?\>\</h1\>  
                	\<div class="breadcrumb"\>  
                    	\<?php if (function\_exists('yoast\_breadcrumb')) {  
                        	yoast\_breadcrumb();  
                    	} ?\>  
                	\</div\>  
                	\<?php if ($image\_url) : ?\>  
                    	\<img src="\<?php echo esc\_url($image\_url); ?\>" alt="\<?php the\_title\_attribute(); ?\>" class="tower-image"\>  
                	\<?php endif; ?\>  
            	\</header\>  
   
            	\<section class="tower-info"\>  
                	\<h2\>ูุนูููุงุช ุฃุณุงุณูุฉ\</h2\>  
                	\<div class="info-grid"\>  
                    	\<div class="info-item"\>\<i class="dashicons dashicons-tag"\>\</i\> \<span\>ุงูุงุณู ุงููุฎุชุตุฑ:\</span\> \<?php echo esc\_html($short\_name); ?\>\</div\>  
                    	\<div class="info-item"\>\<i class="dashicons dashicons-editor-ol"\>\</i\> \<span\>ุนุฏุฏ ุงูุฃุฏูุงุฑ:\</span\> \<?php echo esc\_html($floors); ?\>\</div\>  
                    	\<div class="info-item"\>\<i class="dashicons dashicons-location-alt"\>\</i\> \<span\>ุงููููุน:\</span\> \<?php echo esc\_html($city . ' \- ' . $district); ?\>\</div\>  
                    	\<?php if ($lat && $lng): ?\>  
                        	\<div class="info-item"\>\<i class="dashicons dashicons-admin-map"\>\</i\> \<span\>ุงูุฅุญุฏุงุซูุงุช:\</span\> \<?php echo esc\_html($lat . ', ' . $lng); ?\>\</div\>  
                    	\<?php endif; ?\>  
                	\</div\>  
            	\</section\>  
   
            	\<?php if ($desc) : ?\>  
                	\<section class="tower-description"\>  
                    	\<h2\>ุงููุตู ุงูุนุงู\</h2\>  
                    	\<p\>\<?php echo esc\_html($desc); ?\>\</p\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<?php if ($lat && $lng) : ?\>  
                	\<section class="tower-map"\>  
                    	\<h2\>ุงููููุน ุนูู ุงูุฎุฑูุทุฉ\</h2\>  
                    	\<div id="map" class="map"\>\</div\>  
                    	\<script\>  
                            document.addEventListener("DOMContentLoaded", function () {  
                            	var map \= L.map('map').setView(\[\<?php echo esc\_js($lat); ?\>, \<?php echo esc\_js($lng); ?\>\], 16);  
                                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);  
                                L.marker(\[\<?php echo esc\_js($lat); ?\>, \<?php echo esc\_js($lng); ?\>\]).addTo(map);  
                        	});  
                    	\</script\>  
                	\</section\>  
            	\<?php endif; ?\>  
   
            	\<section class="tower-models"\>  
                	\<h2\>ุงูููุงุฐุฌ ุงูุชุงุจุนุฉ\</h2\>  
                	\<div class="model-list"\>  
                    	\<?php  
                    	$models \= get\_posts(\['post\_type' \=\> 'gre\_model', 'meta\_query' \=\> \[\['key' \=\> '\_gre\_model\_tower\_id', 'value' \=\> $post\_id\]\]\]);  
                    	if ($models) :  
                        	foreach ($models as $model) :  
                    	?\>  
                            	\<div class="model-item"\>  
                                	\<a href="\<?php echo esc\_url(get\_permalink($model-\>ID)); ?\>"\>\<?php echo esc\_html(get\_the\_title($model-\>ID)); ?\>\</a\>  
                            	\</div\>  
                    	\<?php  
                        	endforeach;  
                    	else :  
                        	echo '\<p\>ูุง ุชูุฌุฏ ููุงุฐุฌ ุชุงุจุนุฉ ููุฐุง ุงูุจุฑุฌ.\</p\>';  
                    	endif;  
                    	?\>  
                	\</div\>  
            	\</section\>  
   
            	\<section class="tower-booking"\>  
                	\<a href="\#" class="booking-button"\>ุชูุงุตู ูุนูุง ููุญุฌุฒ\</a\>  
            	\</section\>  
        	\</article\>  
    	\</main\>  
<?php  
	endwhile;  
endif;  
   
get\_sidebar(); // ุงูุดุฑูุท ุงูุฌุงูุจู (ุฅุฐุง ูุงู ููุฌูุฏูุง)  
get\_footer(); // ุชุฐููู ุงููุงูุจ  
?\>  
   
   
   
   
   
